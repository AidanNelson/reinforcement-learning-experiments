{"id":"node_modules/@tensorflow/tfjs-vis/dist/show/model.js","dependencies":[{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js.map","includedInParent":true,"mtime":1550250388843},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/package.json","includedInParent":true,"mtime":1552668533660},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/.babelrc","includedInParent":true,"mtime":1550250231081},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/package.json","includedInParent":true,"mtime":1550250388843},{"name":"../render/histogram","loc":{"line":11,"column":28},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/render/histogram.js"},{"name":"../render/render_utils","loc":{"line":12,"column":31},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/render/render_utils.js"},{"name":"../render/table","loc":{"line":13,"column":24},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/render/table.js"},{"name":"../util/dom","loc":{"line":14,"column":22},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/util/dom.js"},{"name":"../util/math","loc":{"line":15,"column":23},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/show/model.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/tfjs-examples/cart-pole/node_modules/@tensorflow/tfjs-vis/dist/util/math.js"}],"generated":{"js":"\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst histogram_1 = require(\"../render/histogram\");\nconst render_utils_1 = require(\"../render/render_utils\");\nconst table_1 = require(\"../render/table\");\nconst dom_1 = require(\"../util/dom\");\nconst math_1 = require(\"../util/math\");\nfunction modelSummary(container, model) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const drawArea = render_utils_1.getDrawArea(container);\n        const summary = getModelSummary(model);\n        const headers = [\n            'Layer Name',\n            'Output Shape',\n            '# Of Params',\n            'Trainable',\n        ];\n        const values = summary.layers.map(l => [l.name,\n            l.outputShape,\n            l.parameters,\n            l.trainable,\n        ]);\n        table_1.renderTable({ headers, values }, drawArea);\n    });\n}\nexports.modelSummary = modelSummary;\nfunction layer(container, layer) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const drawArea = render_utils_1.getDrawArea(container);\n        const details = yield getLayerDetails(layer);\n        const headers = [\n            'Weight Name',\n            'Shape',\n            'Min',\n            'Max',\n            '# Params',\n            '# Zeros',\n            '# NaNs',\n            '# Infinity',\n        ];\n        const weightsInfoSurface = dom_1.subSurface(drawArea, 'layer-weights-info');\n        const detailValues = details.map(l => [l.name, l.shape, l.stats.min, l.stats.max, l.weight.size,\n            l.stats.numZeros, l.stats.numNans, l.stats.numInfs]);\n        table_1.renderTable({ headers, values: detailValues }, weightsInfoSurface);\n        const histogramSelectorSurface = dom_1.subSurface(drawArea, 'select-layer');\n        const layerValuesHistogram = dom_1.subSurface(drawArea, 'param-distribution');\n        const handleSelection = (layerName) => __awaiter(this, void 0, void 0, function* () {\n            const layer = details.filter(d => d.name === layerName)[0];\n            const weights = yield layer.weight.data();\n            histogram_1.renderHistogram(weights, layerValuesHistogram, { height: 150, width: 460, stats: false });\n        });\n        addHistogramSelector(details.map(d => d.name), histogramSelectorSurface, handleSelection);\n    });\n}\nexports.layer = layer;\nfunction getModelSummary(model) {\n    return {\n        layers: model.layers.map(getLayerSummary),\n    };\n}\nfunction getLayerSummary(layer) {\n    let outputShape;\n    if (Array.isArray(layer.outputShape[0])) {\n        const shapes = layer.outputShape.map(s => formatShape(s));\n        outputShape = `[${shapes.join(', ')}]`;\n    }\n    else {\n        outputShape = formatShape(layer.outputShape);\n    }\n    return {\n        name: layer.name,\n        trainable: layer.trainable,\n        parameters: layer.countParams(),\n        outputShape,\n    };\n}\nfunction getLayerDetails(layer) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const weights = layer.getWeights();\n        const layerVariables = layer.weights;\n        const statsPromises = weights.map(math_1.tensorStats);\n        const stats = yield Promise.all(statsPromises);\n        const shapes = weights.map(w => w.shape);\n        return weights.map((weight, i) => ({\n            name: layerVariables[i].name,\n            stats: stats[i],\n            shape: formatShape(shapes[i]),\n            weight,\n        }));\n    });\n}\nfunction formatShape(shape) {\n    const oShape = shape.slice();\n    if (oShape.length === 0) {\n        return 'Scalar';\n    }\n    if (oShape[0] === null) {\n        oShape[0] = 'batch';\n    }\n    return `[${oShape.join(',')}]`;\n}\nfunction addHistogramSelector(items, parent, selectionHandler) {\n    const select = `\n    <select>\n      ${items.map((i) => `<option value=${i}>${i}</option>`)}\n    </select>\n  `;\n    const button = `<button>Show Values Distribution for:</button>`;\n    const content = `<div>${button}${select}</div>`;\n    parent.innerHTML = content;\n    const buttonEl = parent.querySelector('button');\n    const selectEl = parent.querySelector('select');\n    buttonEl.addEventListener('click', () => {\n        selectionHandler(selectEl.selectedOptions[0].label);\n    });\n}\n","map":{"version":3,"file":"model.js","sourceRoot":"","sources":["../../src/show/model.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"hash":"36750a1690681801409d87ea1d58e935","cacheData":{"env":{}}}