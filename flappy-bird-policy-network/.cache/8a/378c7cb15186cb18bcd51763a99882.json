{"id":"node_modules/@tensorflow/tfjs-vis/dist/show/history.js","dependencies":[{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/show/history.js.map","includedInParent":true,"mtime":1550250388843},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/package.json","includedInParent":true,"mtime":1552694917851},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/.babelrc","includedInParent":true,"mtime":1550250231081},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/package.json","includedInParent":true,"mtime":1550250388843},{"name":"../render/linechart","loc":{"line":11,"column":28},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/show/history.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/render/linechart.js"},{"name":"../render/render_utils","loc":{"line":12,"column":31},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/show/history.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/render/render_utils.js"},{"name":"../util/dom","loc":{"line":13,"column":22},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/show/history.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs-vis/dist/util/dom.js"}],"generated":{"js":"\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst linechart_1 = require(\"../render/linechart\");\nconst render_utils_1 = require(\"../render/render_utils\");\nconst dom_1 = require(\"../util/dom\");\nfunction history(container, history, metrics, opts = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const drawArea = render_utils_1.getDrawArea(container);\n        const plots = {};\n        for (const metric of metrics) {\n            if (!(/val_/.test(metric))) {\n                const values = getValues(history, metric, metrics.indexOf(metric));\n                initPlot(plots, metric);\n                plots[metric].series.push(metric);\n                plots[metric].values.push(values);\n            }\n            else {\n                const nonValidationMetric = metric.replace('val_', '');\n                initPlot(plots, nonValidationMetric);\n                const values = getValues(history, metric, metrics.indexOf(metric));\n                plots[nonValidationMetric].series.push(metric);\n                plots[nonValidationMetric].values.push(values);\n            }\n        }\n        const plotNames = Object.keys(plots);\n        const options = Object.assign({}, { xLabel: 'Iteration', yLabel: 'Value' }, opts);\n        const renderPromises = [];\n        for (const name of plotNames) {\n            const subContainer = dom_1.subSurface(drawArea, name);\n            const series = plots[name].series;\n            const values = plots[name].values;\n            if (series.every(seriesName => Boolean(seriesName.match('acc')))) {\n                if (options.zoomToFitAccuracy) {\n                    options.zoomToFit = true;\n                }\n                else {\n                    options.yAxisDomain = [0, 1];\n                    delete options.zoomToFit;\n                }\n            }\n            const done = linechart_1.renderLinechart({ values, series }, subContainer, options);\n            renderPromises.push(done);\n        }\n        yield Promise.all(renderPromises);\n    });\n}\nexports.history = history;\nfunction initPlot(plot, name) {\n    if (plot[name] == null) {\n        plot[name] = { series: [], values: [] };\n    }\n}\nfunction getValues(history, metric, metricIndex) {\n    if (Array.isArray(history)) {\n        const metricHistory = (Array.isArray(history[0]) ? history[metricIndex] : history);\n        const points = [];\n        for (let i = 0; i < metricHistory.length; i++) {\n            const log = metricHistory[i];\n            points.push({ x: i, y: log[metric] });\n        }\n        return points;\n    }\n    else {\n        return history.history[metric].map((y, x) => ({ x, y }));\n    }\n}\nfunction fitCallbacks(container, metrics, opts = {}) {\n    const accumulators = {};\n    const callbackNames = opts.callbacks || ['onEpochEnd', 'onBatchEnd'];\n    const drawArea = render_utils_1.getDrawArea(container);\n    const historyOpts = Object.assign({}, opts);\n    delete historyOpts.callbacks;\n    function makeCallbackFor(callbackName) {\n        return (_, log) => __awaiter(this, void 0, void 0, function* () {\n            if ((/batch/i).test(callbackName)) {\n                historyOpts.xLabel = 'Batch';\n            }\n            else if ((/epoch/i).test(callbackName)) {\n                historyOpts.xLabel = 'Epoch';\n            }\n            const metricLogs = [];\n            const presentMetrics = [];\n            for (const metric of metrics) {\n                if (log[metric] != null) {\n                    presentMetrics.push(metric);\n                    const accumulator = getAccumulator(accumulators, callbackName, metric);\n                    accumulator.push({ [metric]: log[metric] });\n                    metricLogs.push(accumulator);\n                }\n            }\n            const subContainer = dom_1.subSurface(drawArea, callbackName, { title: callbackName });\n            history(subContainer, metricLogs, presentMetrics, historyOpts);\n            yield render_utils_1.nextFrame();\n        });\n    }\n    const callbacks = {};\n    callbackNames.forEach((name) => {\n        callbacks[name] = makeCallbackFor(name);\n    });\n    return callbacks;\n}\nexports.fitCallbacks = fitCallbacks;\nfunction getAccumulator(accumulators, callback, metric) {\n    if (accumulators[callback] == null) {\n        accumulators[callback] = {};\n    }\n    if (accumulators[callback][metric] == null) {\n        accumulators[callback][metric] = [];\n    }\n    return accumulators[callback][metric];\n}\n","map":{"version":3,"file":"history.js","sourceRoot":"","sources":["../../src/show/history.ts"],"names":[],"mappings":";;;;;;;;;;AAmBA,mDAAoD;AACpD,yDAA8D;AAE9D,qCAAuC;AAsBvC,SAAsB,OAAO,CACzB,SAAmB,EAAE,OAAoB,EAAE,OAAiB,EAC5D,OAAuB,EAAE;;QAE3B,MAAM,QAAQ,GAAG,0BAAW,CAAC,SAAS,CAAC,CAAC;QAKxC,MAAM,KAAK,GAAoB,EAAE,CAAC;QAClC,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;YAC5B,IAAI,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE;gBAE1B,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;gBACnE,QAAQ,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;gBACxB,KAAK,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAClC,KAAK,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACnC;iBAAM;gBAIL,MAAM,mBAAmB,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;gBACvD,QAAQ,CAAC,KAAK,EAAE,mBAAmB,CAAC,CAAC;gBACrC,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;gBACnE,KAAK,CAAC,mBAAmB,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAC/C,KAAK,CAAC,mBAAmB,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAChD;SACF;QAID,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,MAAM,OAAO,GACT,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,EAAC,MAAM,EAAE,WAAW,EAAE,MAAM,EAAE,OAAO,EAAC,EAAE,IAAI,CAAC,CAAC;QAEpE,MAAM,cAAc,GAAG,EAAE,CAAC;QAC1B,KAAK,MAAM,IAAI,IAAI,SAAS,EAAE;YAC5B,MAAM,YAAY,GAAG,gBAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YAChD,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;YAClC,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;YAElC,IAAI,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;gBAGhE,IAAI,OAAO,CAAC,iBAAiB,EAAE;oBAC7B,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;iBAC1B;qBAAM;oBACL,OAAO,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAC7B,OAAO,OAAO,CAAC,SAAS,CAAC;iBAC1B;aACF;YAED,MAAM,IAAI,GAAG,2BAAe,CAAC,EAAC,MAAM,EAAE,MAAM,EAAC,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;YACtE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC3B;QACD,MAAM,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;IACpC,CAAC;CAAA;AAxDD,0BAwDC;AAmBD,SAAS,QAAQ,CAAC,IAAqB,EAAE,IAAY;IACnD,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE;QACtB,IAAI,CAAC,IAAI,CAAC,GAAG,EAAC,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAC,CAAC;KACvC;AACH,CAAC;AAWD,SAAS,SAAS,CACd,OAAoB,EAAE,MAAc,EAAE,WAAmB;IAC3D,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;QAG1B,MAAM,aAAa,GACf,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,OAAO,CAAW,CAAC;QAC3E,MAAM,MAAM,GAAc,EAAE,CAAC;QAE7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,MAAM,GAAG,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;YAC7B,MAAM,CAAC,IAAI,CAAC,EAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,EAAC,CAAC,CAAC;SACrC;QACD,OAAO,MAAM,CAAC;KACf;SAAM;QACL,OAAQ,OAAO,CAAC,OAAO,CAAC,MAAM,CAAc,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAC,CAAC,EAAE,CAAC,EAAC,CAAC,CAAC,CAAC;KACtE;AACH,CAAC;AAqBD,SAAgB,YAAY,CACxB,SAAmB,EAAE,OAAiB,EACtC,OAA2B,EAAE;IAC/B,MAAM,YAAY,GAAoB,EAAE,CAAC;IACzC,MAAM,aAAa,GAAG,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE,YAAY,CAAC,CAAC;IACrE,MAAM,QAAQ,GAAG,0BAAW,CAAC,SAAS,CAAC,CAAC;IAExC,MAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;IAC5C,OAAO,WAAW,CAAC,SAAS,CAAC;IAC7B,SAAS,eAAe,CAAC,YAAoB;QAC3C,OAAO,CAAO,CAAS,EAAE,GAAS,EAAE,EAAE;YAEpC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;gBACjC,WAAW,CAAC,MAAM,GAAG,OAAO,CAAC;aAC9B;iBAAM,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;gBACxC,WAAW,CAAC,MAAM,GAAG,OAAO,CAAC;aAC9B;YAWD,MAAM,UAAU,GAAa,EAAE,CAAC;YAChC,MAAM,cAAc,GAAa,EAAE,CAAC;YACpC,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;gBAE5B,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,IAAI,EAAE;oBACvB,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAE5B,MAAM,WAAW,GACb,cAAc,CAAC,YAAY,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;oBACvD,WAAW,CAAC,IAAI,CAAC,EAAC,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,EAAC,CAAC,CAAC;oBAC1C,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;iBAC9B;aACF;YAED,MAAM,YAAY,GACd,gBAAU,CAAC,QAAQ,EAAE,YAAY,EAAE,EAAC,KAAK,EAAE,YAAY,EAAC,CAAC,CAAC;YAC9D,OAAO,CAAC,YAAY,EAAE,UAAU,EAAE,cAAc,EAAE,WAAW,CAAC,CAAC;YAC/D,MAAM,wBAAS,EAAE,CAAC;QACpB,CAAC,CAAA,CAAC;IACJ,CAAC;IAED,MAAM,SAAS,GAAwB,EAAE,CAAC;IAC1C,aAAa,CAAC,OAAO,CAAC,CAAC,IAAY,EAAE,EAAE;QACrC,SAAS,CAAC,IAAI,CAAC,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;IAC1C,CAAC,CAAC,CAAC;IACH,OAAO,SAAS,CAAC;AACnB,CAAC;AArDD,oCAqDC;AAgBD,SAAS,cAAc,CACnB,YAA6B,EAAE,QAAgB,EAAE,MAAc;IACjE,IAAI,YAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,EAAE;QAClC,YAAY,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC;KAC7B;IACD,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,IAAI,IAAI,EAAE;QAC1C,YAAY,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;KACrC;IACD,OAAO,YAAY,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC;AACxC,CAAC","sourcesContent":[null]}},"hash":"26f06e6d1b92b94a06a312047af352ce","cacheData":{"env":{}}}