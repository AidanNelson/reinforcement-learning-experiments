{"id":"index.js","dependencies":[{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/.babelrc","includedInParent":true,"mtime":1550250231081},{"name":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/package.json","includedInParent":true,"mtime":1552694917851},{"name":"@tensorflow/tfjs","loc":{"line":37,"column":20},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/index.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/node_modules/@tensorflow/tfjs/dist/tf.esm.js"},{"name":"./ui","loc":{"line":39,"column":60},"parent":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/index.js","resolved":"/Users/aidannelson/projects/machine-learning/ml5js/reinforcement-learning/experiments/cart-pole-aidan/ui.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SaveablePolicyNetwork = void 0;\n\nvar tf = _interopRequireWildcard(require(\"@tensorflow/tfjs\"));\n\nvar _ui = require(\"./ui\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\n/**\n * @license\n * Copyright 2018 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\n/**\n * TensorFlow.js Reinforcement Learning Example: Balancing a Cart-Pole System.\n *\n * The simulation, training, testing and visualization parts are written\n * purely in JavaScript and can run in the web browser with WebGL acceleration.\n *\n * This reinforcement learning (RL) problem was proposed in:\n *\n * - Barto, Sutton, and Anderson, \"Neuronlike Adaptive Elements That Can Solve\n *   Difficult Learning Control Problems,\" IEEE Trans. Syst., Man, Cybern.,\n *   Vol. SMC-13, pp. 834--846, Sept.--Oct. 1983\n * - Sutton, \"Temporal Aspects of Credit Assignment in Reinforcement Learning\",\n *   Ph.D. Dissertation, Department of Computer and Information Science,\n *   University of Massachusetts, Amherst, 1984.\n *\n * It later became one of OpenAI's gym environmnets:\n *   https://github.com/openai/gym/blob/master/gym/envs/classic_control/cartpole.py\n */\n\n/**\n * Policy network for controlling the cart-pole system.\n *\n * The role of the policy network is to select an action based on the observed\n * state of the system. In this case, the action is the leftward or rightward\n * force and the observed system state is a four-dimensional vector, consisting\n * of cart position, cart velocity, pole angle and pole angular velocity.\n *\n */\nclass PolicyNetwork {\n  /**\n   * Constructor of PolicyNetwork.\n   *\n   * @param {number | number[] | tf.Model} hiddenLayerSizes\n   *   Can be any of the following\n   *   - Size of the hidden layer, as a single number (for a single hidden\n   *     layer)\n   *   - An Array of numbers (for any number of hidden layers).\n   *   - An instance of tf.Model.\n   */\n  constructor(hiddenLayerSizesOrModel) {\n    if (hiddenLayerSizesOrModel instanceof tf.Model) {\n      this.model = hiddenLayerSizesOrModel;\n    } else {\n      this.createModel(hiddenLayerSizesOrModel);\n    }\n  }\n  /**\n   * Create the underlying model of this policy network.\n   *\n   * @param {number | number[]} hiddenLayerSizes Size of the hidden layer, as\n   *   a single number (for a single hidden layer) or an Array of numbers (for\n   *   any number of hidden layers).\n   */\n\n\n  createModel(hiddenLayerSizes) {\n    if (!Array.isArray(hiddenLayerSizes)) {\n      hiddenLayerSizes = [hiddenLayerSizes];\n    }\n\n    this.model = tf.sequential();\n    hiddenLayerSizes.forEach((hiddenLayerSize, i) => {\n      this.model.add(tf.layers.dense({\n        units: hiddenLayerSize,\n        activation: 'elu',\n        // `inputShape` is required only for the first layer.\n        inputShape: i === 0 ? [4] : undefined\n      }));\n    }); // The last layer has only one unit. The single output number will be\n    // converted to a probability of selecting the leftward-force action.\n\n    this.model.add(tf.layers.dense({\n      units: 1\n    }));\n  }\n  /**\n   * Train the policy network's model.\n   *\n   * @param {CartPole} cartPoleSystem The cart-pole system object to use during\n   *   training.\n   * @param {tf.train.Optimizer} optimizer An instance of TensorFlow.js\n   *   Optimizer to use for training.\n   * @param {number} discountRate Reward discounting rate: a number between 0\n   *   and 1.\n   * @param {number} numGames Number of game to play for each model parameter\n   *   update.\n   * @param {number} maxStepsPerGame Maximum number of steps to perform during\n   *   a game. If this number is reached, the game will end immediately.\n   * @returns {number[]} The number of steps completed in the `numGames` games\n   *   in this round of training.\n   */\n\n\n  async train(cartPoleSystem, optimizer, discountRate, numGames, maxStepsPerGame) {\n    const allGradients = [];\n    const allRewards = [];\n    const gameSteps = [];\n    (0, _ui.onGameEnd)(0, numGames);\n\n    for (let i = 0; i < numGames; ++i) {\n      // Randomly initialize the state of the cart-pole system at the beginning\n      // of every game.\n      cartPoleSystem.setRandomState();\n      const gameRewards = [];\n      const gameGradients = [];\n\n      for (let j = 0; j < maxStepsPerGame; ++j) {\n        // For every step of the game, remember gradients of the policy\n        // network's weights with respect to the probability of the action\n        // choice that lead to the reward.\n        const gradients = tf.tidy(() => {\n          const inputTensor = cartPoleSystem.getStateTensor();\n          return this.getGradientsAndSaveActions(inputTensor).grads;\n        });\n        this.pushGradients(gameGradients, gradients);\n        const action = this.currentActions_[0];\n        const isDone = cartPoleSystem.update(action);\n        await (0, _ui.maybeRenderDuringTraining)(cartPoleSystem);\n\n        if (isDone) {\n          // When the game ends before max step count is reached, a reward of\n          // 0 is given.\n          gameRewards.push(0);\n          break;\n        } else {\n          // As long as the game doesn't end, each step leads to a reward of 1.\n          // These reward values will later be \"discounted\", leading to\n          // higher reward values for longer-lasting games.\n          gameRewards.push(1);\n        }\n      }\n\n      (0, _ui.onGameEnd)(i + 1, numGames);\n      gameSteps.push(gameRewards.length);\n      this.pushGradients(allGradients, gameGradients);\n      allRewards.push(gameRewards);\n      await tf.nextFrame();\n    }\n\n    tf.tidy(() => {\n      // The following line does three things:\n      // 1. Performs reward discounting, i.e., make recent rewards count more\n      //    than rewards from the further past. The effect is that the reward\n      //    values from a game with many steps become larger than the values\n      //    from a game with fewer steps.\n      // 2. Normalize the rewards, i.e., subtract the global mean value of the\n      //    rewards and divide the result by the global standard deviation of\n      //    the rewards. Together with step 1, this makes the rewards from\n      //    long-lasting games positive and rewards from short-lasting\n      //    negative.\n      // 3. Scale the gradients with the normalized reward values.\n      const normalizedRewards = discountAndNormalizeRewards(allRewards, discountRate); // Add the scaled gradients to the weights of the policy network. This\n      // step makes the policy network more likely to make choices that lead\n      // to long-lasting games in the future (i.e., the crux of this RL\n      // algorithm.)\n\n      optimizer.applyGradients(scaleAndAverageGradients(allGradients, normalizedRewards));\n    });\n    tf.dispose(allGradients);\n    return gameSteps;\n  }\n\n  getGradientsAndSaveActions(inputTensor) {\n    const f = () => tf.tidy(() => {\n      const [logits, actions] = this.getLogitsAndActions(inputTensor);\n      this.currentActions_ = actions.dataSync();\n      const labels = tf.sub(1, tf.tensor2d(this.currentActions_, actions.shape));\n      return tf.losses.sigmoidCrossEntropy(labels, logits).asScalar();\n    });\n\n    return tf.variableGrads(f);\n  }\n\n  getCurrentActions() {\n    return this.currentActions_;\n  }\n  /**\n   * Get policy-network logits and the action based on state-tensor inputs.\n   *\n   * @param {tf.Tensor} inputs A tf.Tensor instance of shape `[batchSize, 4]`.\n   * @returns {[tf.Tensor, tf.Tensor]}\n   *   1. The logits tensor, of shape `[batchSize, 1]`.\n   *   2. The actions tensor, of shape `[batchSize, 1]`.\n   */\n\n\n  getLogitsAndActions(inputs) {\n    return tf.tidy(() => {\n      const logits = this.model.predict(inputs); // Get the probability of the leftward action.\n\n      const leftProb = tf.sigmoid(logits); // Probabilites of the left and right actions.\n\n      const leftRightProbs = tf.concat([leftProb, tf.sub(1, leftProb)], 1);\n      const actions = tf.multinomial(leftRightProbs, 1, null, true);\n      return [logits, actions];\n    });\n  }\n  /**\n   * Get actions based on a state-tensor input.\n   *\n   * @param {tf.Tensor} inputs A tf.Tensor instance of shape `[batchSize, 4]`.\n   * @param {Float32Array} inputs The actions for the inputs, with length\n   *   `batchSize`.\n   */\n\n\n  getActions(inputs) {\n    return this.getLogitsAndActions(inputs)[1].dataSync();\n  }\n  /**\n   * Push a new dictionary of gradients into records.\n   *\n   * @param {{[varName: string]: tf.Tensor[]}} record The record of variable\n   *   gradient: a map from variable name to the Array of gradient values for\n   *   the variable.\n   * @param {{[varName: string]: tf.Tensor}} gradients The new gradients to push\n   *   into `record`: a map from variable name to the gradient Tensor.\n   */\n\n\n  pushGradients(record, gradients) {\n    for (const key in gradients) {\n      if (key in record) {\n        record[key].push(gradients[key]);\n      } else {\n        record[key] = [gradients[key]];\n      }\n    }\n  }\n\n} // The IndexedDB path where the model of the policy network will be saved.\n\n\nconst MODEL_SAVE_PATH_ = 'indexeddb://cart-pole-v1';\n/**\n * A subclass of PolicyNetwork that supports saving and loading.\n */\n\nclass SaveablePolicyNetwork extends PolicyNetwork {\n  /**\n   * Constructor of SaveablePolicyNetwork\n   *\n   * @param {number | number[]} hiddenLayerSizesOrModel\n   */\n  constructor(hiddenLayerSizesOrModel) {\n    super(hiddenLayerSizesOrModel);\n  }\n  /**\n   * Save the model to IndexedDB.\n   */\n\n\n  async saveModel() {\n    return await this.model.save(MODEL_SAVE_PATH_);\n  }\n  /**\n   * Load the model fom IndexedDB.\n   *\n   * @returns {SaveablePolicyNetwork} The instance of loaded\n   *   `SaveablePolicyNetwork`.\n   * @throws {Error} If no model can be found in IndexedDB.\n   */\n\n\n  static async loadModel() {\n    const modelsInfo = await tf.io.listModels();\n\n    if (MODEL_SAVE_PATH_ in modelsInfo) {\n      console.log(`Loading existing model...`);\n      const model = await tf.loadModel(MODEL_SAVE_PATH_);\n      console.log(`Loaded model from ${MODEL_SAVE_PATH_}`);\n      return new SaveablePolicyNetwork(model);\n    } else {\n      throw new Error(`Cannot find model at ${MODEL_SAVE_PATH_}.`);\n    }\n  }\n  /**\n   * Check the status of locally saved model.\n   *\n   * @returns If the locally saved model exists, the model info as a JSON\n   *   object. Else, `undefined`.\n   */\n\n\n  static async checkStoredModelStatus() {\n    const modelsInfo = await tf.io.listModels();\n    return modelsInfo[MODEL_SAVE_PATH_];\n  }\n  /**\n   * Remove the locally saved model from IndexedDB.\n   */\n\n\n  async removeModel() {\n    return await tf.io.removeModel(MODEL_SAVE_PATH_);\n  }\n  /**\n   * Get the sizes of the hidden layers.\n   *\n   * @returns {number | number[]} If the model has only one hidden layer,\n   *   return the size of the layer as a single number. If the model has\n   *   multiple hidden layers, return the sizes as an Array of numbers.\n   */\n\n\n  hiddenLayerSizes() {\n    const sizes = [];\n\n    for (let i = 0; i < this.model.layers.length - 1; ++i) {\n      sizes.push(this.model.layers[i].units);\n    }\n\n    return sizes.length === 1 ? sizes[0] : sizes;\n  }\n\n}\n/**\n * Discount the reward values.\n *\n * @param {number[]} rewards The reward values to be discounted.\n * @param {number} discountRate Discount rate: a number between 0 and 1, e.g.,\n *   0.95.\n * @returns {tf.Tensor} The discounted reward values as a 1D tf.Tensor.\n */\n\n\nexports.SaveablePolicyNetwork = SaveablePolicyNetwork;\n\nfunction discountRewards(rewards, discountRate) {\n  const discountedBuffer = tf.buffer([rewards.length]);\n  let prev = 0;\n\n  for (let i = rewards.length - 1; i >= 0; --i) {\n    const current = discountRate * prev + rewards[i];\n    discountedBuffer.set(current, i);\n    prev = current;\n  }\n\n  return discountedBuffer.toTensor();\n}\n/**\n * Discount and normalize reward values.\n *\n * This function performs two steps:\n *\n * 1. Discounts the reward values using `discountRate`.\n * 2. Normalize the reward values with the global reward mean and standard\n *    deviation.\n *\n * @param {number[][]} rewardSequences Sequences of reward values.\n * @param {number} discountRate Discount rate: a number between 0 and 1, e.g.,\n *   0.95.\n * @returns {tf.Tensor[]} The discounted and normalize reward values as an\n *   Array of tf.Tensor.\n */\n\n\nfunction discountAndNormalizeRewards(rewardSequences, discountRate) {\n  return tf.tidy(() => {\n    const discounted = [];\n\n    for (const sequence of rewardSequences) {\n      discounted.push(discountRewards(sequence, discountRate));\n    } // Compute the overall mean and stddev.\n\n\n    const concatenated = tf.concat(discounted);\n    const mean = tf.mean(concatenated);\n    const std = tf.sqrt(tf.mean(tf.square(concatenated.sub(mean)))); // Normalize the reward sequences using the mean and std.\n\n    const normalized = discounted.map(rs => rs.sub(mean).div(std));\n    return normalized;\n  });\n}\n/**\n * Scale the gradient values using normalized reward values and compute average.\n *\n * The gradient values are scaled by the normalized reward values. Then they\n * are averaged across all games and all steps.\n *\n * @param {{[varName: string]: tf.Tensor[][]}} allGradients A map from variable\n *   name to all the gradient values for the variable across all games and all\n *   steps.\n * @param {tf.Tensor[]} normalizedRewards An Array of normalized reward values\n *   for all the games. Each element of the Array is a 1D tf.Tensor of which\n *   the length equals the number of steps in the game.\n * @returns {{[varName: string]: tf.Tensor}} Scaled and averaged gradients\n *   for the variables.\n */\n\n\nfunction scaleAndAverageGradients(allGradients, normalizedRewards) {\n  return tf.tidy(() => {\n    const gradients = {};\n\n    for (const varName in allGradients) {\n      gradients[varName] = tf.tidy(() => {\n        // Stack gradients together.\n        const varGradients = allGradients[varName].map(varGameGradients => tf.stack(varGameGradients)); // Expand dimensions of reward tensors to prepare for multiplication\n        // with broadcasting.\n\n        const expandedDims = [];\n\n        for (let i = 0; i < varGradients[0].rank - 1; ++i) {\n          expandedDims.push(1);\n        }\n\n        const reshapedNormalizedRewards = normalizedRewards.map(rs => rs.reshape(rs.shape.concat(expandedDims)));\n\n        for (let g = 0; g < varGradients.length; ++g) {\n          // This mul() call uses broadcasting.\n          varGradients[g] = varGradients[g].mul(reshapedNormalizedRewards[g]);\n        } // Concatenate the scaled gradients together, then average them across\n        // all the steps of all the games.\n\n\n        return tf.mean(tf.concat(varGradients, 0), 0);\n      });\n    }\n\n    return gradients;\n  });\n}\n\n(0, _ui.setUpUI)();","map":{"mappings":[{"generated":{"line":8,"column":0},"source":"index.js","original":{"line":37,"column":0}},{"generated":{"line":10,"column":0},"source":"index.js","original":{"line":39,"column":0}},{"generated":{"line":14,"column":0},"source":"index.js","original":{"line":1,"column":0}},{"generated":{"line":31,"column":0},"source":"index.js","original":{"line":18,"column":0}},{"generated":{"line":50,"column":0},"source":"index.js","original":{"line":41,"column":0}},{"generated":{"line":59,"column":0},"source":"index.js","original":{"line":50,"column":0}},{"name":"PolicyNetwork","generated":{"line":59,"column":6},"source":"index.js","original":{"line":50,"column":6}},{"generated":{"line":59,"column":19},"source":"index.js","original":{"line":50,"column":0}},{"generated":{"line":59,"column":20},"source":"index.js","original":{"line":50,"column":20}},{"generated":{"line":60,"column":0},"source":"index.js","original":{"line":51,"column":2}},{"name":"constructor","generated":{"line":70,"column":0},"source":"index.js","original":{"line":61,"column":2}},{"name":"constructor","generated":{"line":70,"column":2},"source":"index.js","original":{"line":61,"column":2}},{"generated":{"line":70,"column":13},"source":"index.js","original":{"line":61,"column":13}},{"name":"hiddenLayerSizesOrModel","generated":{"line":70,"column":14},"source":"index.js","original":{"line":61,"column":14}},{"generated":{"line":70,"column":37},"source":"index.js","original":{"line":61,"column":13}},{"generated":{"line":70,"column":39},"source":"index.js","original":{"line":61,"column":39}},{"generated":{"line":71,"column":0},"source":"index.js","original":{"line":62,"column":4}},{"name":"hiddenLayerSizesOrModel","generated":{"line":71,"column":8},"source":"index.js","original":{"line":62,"column":8}},{"generated":{"line":71,"column":31},"source":"index.js","original":{"line":62,"column":31}},{"name":"tf","generated":{"line":71,"column":43},"source":"index.js","original":{"line":62,"column":43}},{"generated":{"line":71,"column":45},"source":"index.js","original":{"line":62,"column":45}},{"name":"Model","generated":{"line":71,"column":46},"source":"index.js","original":{"line":62,"column":46}},{"generated":{"line":71,"column":51},"source":"index.js","original":{"line":62,"column":4}},{"generated":{"line":71,"column":53},"source":"index.js","original":{"line":62,"column":53}},{"generated":{"line":72,"column":0},"source":"index.js","original":{"line":63,"column":6}},{"name":"model","generated":{"line":72,"column":11},"source":"index.js","original":{"line":63,"column":11}},{"generated":{"line":72,"column":16},"source":"index.js","original":{"line":63,"column":6}},{"name":"hiddenLayerSizesOrModel","generated":{"line":72,"column":19},"source":"index.js","original":{"line":63,"column":19}},{"generated":{"line":72,"column":42},"source":"index.js","original":{"line":63,"column":6}},{"generated":{"line":73,"column":0},"source":"index.js","original":{"line":64,"column":5}},{"generated":{"line":73,"column":5},"source":"index.js","original":{"line":62,"column":4}},{"generated":{"line":73,"column":11},"source":"index.js","original":{"line":64,"column":11}},{"generated":{"line":74,"column":0},"source":"index.js","original":{"line":65,"column":6}},{"name":"createModel","generated":{"line":74,"column":11},"source":"index.js","original":{"line":65,"column":11}},{"generated":{"line":74,"column":22},"source":"index.js","original":{"line":65,"column":6}},{"name":"hiddenLayerSizesOrModel","generated":{"line":74,"column":23},"source":"index.js","original":{"line":65,"column":23}},{"generated":{"line":74,"column":46},"source":"index.js","original":{"line":65,"column":6}},{"generated":{"line":75,"column":0},"source":"index.js","original":{"line":66,"column":5}},{"generated":{"line":76,"column":0},"source":"index.js","original":{"line":67,"column":3}},{"generated":{"line":77,"column":0},"source":"index.js","original":{"line":69,"column":2}},{"name":"createModel","generated":{"line":86,"column":0},"source":"index.js","original":{"line":76,"column":2}},{"name":"createModel","generated":{"line":86,"column":2},"source":"index.js","original":{"line":76,"column":2}},{"generated":{"line":86,"column":13},"source":"index.js","original":{"line":76,"column":13}},{"name":"hiddenLayerSizes","generated":{"line":86,"column":14},"source":"index.js","original":{"line":76,"column":14}},{"generated":{"line":86,"column":30},"source":"index.js","original":{"line":76,"column":13}},{"generated":{"line":86,"column":32},"source":"index.js","original":{"line":76,"column":32}},{"generated":{"line":87,"column":0},"source":"index.js","original":{"line":77,"column":4}},{"generated":{"line":87,"column":8},"source":"index.js","original":{"line":77,"column":8}},{"name":"Array","generated":{"line":87,"column":9},"source":"index.js","original":{"line":77,"column":9}},{"generated":{"line":87,"column":14},"source":"index.js","original":{"line":77,"column":14}},{"name":"isArray","generated":{"line":87,"column":15},"source":"index.js","original":{"line":77,"column":15}},{"generated":{"line":87,"column":22},"source":"index.js","original":{"line":77,"column":9}},{"name":"hiddenLayerSizes","generated":{"line":87,"column":23},"source":"index.js","original":{"line":77,"column":23}},{"generated":{"line":87,"column":39},"source":"index.js","original":{"line":77,"column":9}},{"generated":{"line":87,"column":40},"source":"index.js","original":{"line":77,"column":4}},{"generated":{"line":87,"column":42},"source":"index.js","original":{"line":77,"column":42}},{"name":"hiddenLayerSizes","generated":{"line":88,"column":0},"source":"index.js","original":{"line":78,"column":6}},{"name":"hiddenLayerSizes","generated":{"line":88,"column":6},"source":"index.js","original":{"line":78,"column":6}},{"generated":{"line":88,"column":22},"source":"index.js","original":{"line":78,"column":22}},{"generated":{"line":88,"column":25},"source":"index.js","original":{"line":78,"column":25}},{"name":"hiddenLayerSizes","generated":{"line":88,"column":26},"source":"index.js","original":{"line":78,"column":26}},{"generated":{"line":88,"column":42},"source":"index.js","original":{"line":78,"column":25}},{"generated":{"line":88,"column":43},"source":"index.js","original":{"line":78,"column":6}},{"generated":{"line":89,"column":0},"source":"index.js","original":{"line":79,"column":5}},{"generated":{"line":91,"column":0},"source":"index.js","original":{"line":80,"column":4}},{"name":"model","generated":{"line":91,"column":9},"source":"index.js","original":{"line":80,"column":9}},{"generated":{"line":91,"column":14},"source":"index.js","original":{"line":80,"column":4}},{"name":"tf","generated":{"line":91,"column":17},"source":"index.js","original":{"line":80,"column":17}},{"generated":{"line":91,"column":19},"source":"index.js","original":{"line":80,"column":19}},{"name":"sequential","generated":{"line":91,"column":20},"source":"index.js","original":{"line":80,"column":20}},{"generated":{"line":91,"column":30},"source":"index.js","original":{"line":80,"column":17}},{"generated":{"line":91,"column":32},"source":"index.js","original":{"line":80,"column":4}},{"name":"hiddenLayerSizes","generated":{"line":92,"column":0},"source":"index.js","original":{"line":81,"column":4}},{"name":"hiddenLayerSizes","generated":{"line":92,"column":4},"source":"index.js","original":{"line":81,"column":4}},{"generated":{"line":92,"column":20},"source":"index.js","original":{"line":81,"column":20}},{"name":"forEach","generated":{"line":92,"column":21},"source":"index.js","original":{"line":81,"column":21}},{"generated":{"line":92,"column":28},"source":"index.js","original":{"line":81,"column":4}},{"generated":{"line":92,"column":29},"source":"index.js","original":{"line":81,"column":29}},{"name":"hiddenLayerSize","generated":{"line":92,"column":30},"source":"index.js","original":{"line":81,"column":30}},{"generated":{"line":92,"column":45},"source":"index.js","original":{"line":81,"column":29}},{"name":"i","generated":{"line":92,"column":47},"source":"index.js","original":{"line":81,"column":47}},{"generated":{"line":92,"column":48},"source":"index.js","original":{"line":81,"column":29}},{"generated":{"line":92,"column":53},"source":"index.js","original":{"line":81,"column":53}},{"generated":{"line":93,"column":0},"source":"index.js","original":{"line":82,"column":6}},{"name":"model","generated":{"line":93,"column":11},"source":"index.js","original":{"line":82,"column":11}},{"generated":{"line":93,"column":16},"source":"index.js","original":{"line":82,"column":6}},{"name":"add","generated":{"line":93,"column":17},"source":"index.js","original":{"line":82,"column":17}},{"generated":{"line":93,"column":20},"source":"index.js","original":{"line":82,"column":6}},{"name":"tf","generated":{"line":93,"column":21},"source":"index.js","original":{"line":82,"column":21}},{"generated":{"line":93,"column":23},"source":"index.js","original":{"line":82,"column":23}},{"name":"layers","generated":{"line":93,"column":24},"source":"index.js","original":{"line":82,"column":24}},{"generated":{"line":93,"column":30},"source":"index.js","original":{"line":82,"column":21}},{"name":"dense","generated":{"line":93,"column":31},"source":"index.js","original":{"line":82,"column":31}},{"generated":{"line":93,"column":36},"source":"index.js","original":{"line":82,"column":21}},{"generated":{"line":93,"column":37},"source":"index.js","original":{"line":82,"column":37}},{"name":"units","generated":{"line":94,"column":0},"source":"index.js","original":{"line":83,"column":8}},{"name":"units","generated":{"line":94,"column":8},"source":"index.js","original":{"line":83,"column":8}},{"generated":{"line":94,"column":13},"source":"index.js","original":{"line":83,"column":13}},{"name":"hiddenLayerSize","generated":{"line":94,"column":15},"source":"index.js","original":{"line":83,"column":15}},{"generated":{"line":94,"column":30},"source":"index.js","original":{"line":82,"column":37}},{"name":"activation","generated":{"line":95,"column":0},"source":"index.js","original":{"line":84,"column":8}},{"name":"activation","generated":{"line":95,"column":8},"source":"index.js","original":{"line":84,"column":8}},{"generated":{"line":95,"column":18},"source":"index.js","original":{"line":84,"column":18}},{"generated":{"line":95,"column":20},"source":"index.js","original":{"line":84,"column":20}},{"generated":{"line":95,"column":25},"source":"index.js","original":{"line":82,"column":37}},{"generated":{"line":96,"column":0},"source":"index.js","original":{"line":85,"column":8}},{"name":"inputShape","generated":{"line":97,"column":0},"source":"index.js","original":{"line":86,"column":8}},{"name":"inputShape","generated":{"line":97,"column":8},"source":"index.js","original":{"line":86,"column":8}},{"generated":{"line":97,"column":18},"source":"index.js","original":{"line":86,"column":18}},{"name":"i","generated":{"line":97,"column":20},"source":"index.js","original":{"line":86,"column":20}},{"generated":{"line":97,"column":21},"source":"index.js","original":{"line":86,"column":21}},{"generated":{"line":97,"column":26},"source":"index.js","original":{"line":86,"column":26}},{"generated":{"line":97,"column":27},"source":"index.js","original":{"line":86,"column":20}},{"generated":{"line":97,"column":30},"source":"index.js","original":{"line":86,"column":30}},{"generated":{"line":97,"column":31},"source":"index.js","original":{"line":86,"column":31}},{"generated":{"line":97,"column":32},"source":"index.js","original":{"line":86,"column":30}},{"generated":{"line":97,"column":33},"source":"index.js","original":{"line":86,"column":20}},{"name":"undefined","generated":{"line":97,"column":36},"source":"index.js","original":{"line":86,"column":36}},{"generated":{"line":98,"column":0},"source":"index.js","original":{"line":82,"column":37}},{"generated":{"line":98,"column":7},"source":"index.js","original":{"line":82,"column":21}},{"generated":{"line":98,"column":8},"source":"index.js","original":{"line":82,"column":6}},{"generated":{"line":99,"column":0},"source":"index.js","original":{"line":88,"column":5}},{"generated":{"line":99,"column":5},"source":"index.js","original":{"line":81,"column":4}},{"generated":{"line":99,"column":7},"source":"index.js","original":{"line":76,"column":32}},{"generated":{"line":99,"column":8},"source":"index.js","original":{"line":89,"column":4}},{"generated":{"line":100,"column":0},"source":"index.js","original":{"line":90,"column":4}},{"generated":{"line":102,"column":0},"source":"index.js","original":{"line":91,"column":4}},{"name":"model","generated":{"line":102,"column":9},"source":"index.js","original":{"line":91,"column":9}},{"generated":{"line":102,"column":14},"source":"index.js","original":{"line":91,"column":4}},{"name":"add","generated":{"line":102,"column":15},"source":"index.js","original":{"line":91,"column":15}},{"generated":{"line":102,"column":18},"source":"index.js","original":{"line":91,"column":4}},{"name":"tf","generated":{"line":102,"column":19},"source":"index.js","original":{"line":91,"column":19}},{"generated":{"line":102,"column":21},"source":"index.js","original":{"line":91,"column":21}},{"name":"layers","generated":{"line":102,"column":22},"source":"index.js","original":{"line":91,"column":22}},{"generated":{"line":102,"column":28},"source":"index.js","original":{"line":91,"column":19}},{"name":"dense","generated":{"line":102,"column":29},"source":"index.js","original":{"line":91,"column":29}},{"generated":{"line":102,"column":34},"source":"index.js","original":{"line":91,"column":19}},{"generated":{"line":102,"column":35},"source":"index.js","original":{"line":91,"column":35}},{"name":"units","generated":{"line":103,"column":0},"source":"index.js","original":{"line":91,"column":36}},{"name":"units","generated":{"line":103,"column":6},"source":"index.js","original":{"line":91,"column":36}},{"generated":{"line":103,"column":11},"source":"index.js","original":{"line":91,"column":41}},{"generated":{"line":103,"column":13},"source":"index.js","original":{"line":91,"column":43}},{"generated":{"line":104,"column":0},"source":"index.js","original":{"line":91,"column":35}},{"generated":{"line":104,"column":5},"source":"index.js","original":{"line":91,"column":19}},{"generated":{"line":104,"column":6},"source":"index.js","original":{"line":91,"column":4}},{"generated":{"line":105,"column":0},"source":"index.js","original":{"line":92,"column":3}},{"generated":{"line":106,"column":0},"source":"index.js","original":{"line":94,"column":2}},{"generated":{"line":124,"column":0},"source":"index.js","original":{"line":110,"column":2}},{"name":"train","generated":{"line":124,"column":8},"source":"index.js","original":{"line":110,"column":8}},{"generated":{"line":124,"column":13},"source":"index.js","original":{"line":110,"column":2}},{"name":"cartPoleSystem","generated":{"line":124,"column":14},"source":"index.js","original":{"line":111,"column":6}},{"generated":{"line":124,"column":28},"source":"index.js","original":{"line":110,"column":2}},{"name":"optimizer","generated":{"line":124,"column":30},"source":"index.js","original":{"line":111,"column":22}},{"generated":{"line":124,"column":39},"source":"index.js","original":{"line":110,"column":2}},{"name":"discountRate","generated":{"line":124,"column":41},"source":"index.js","original":{"line":111,"column":33}},{"generated":{"line":124,"column":53},"source":"index.js","original":{"line":110,"column":2}},{"name":"numGames","generated":{"line":124,"column":55},"source":"index.js","original":{"line":111,"column":47}},{"generated":{"line":124,"column":63},"source":"index.js","original":{"line":110,"column":2}},{"name":"maxStepsPerGame","generated":{"line":124,"column":65},"source":"index.js","original":{"line":111,"column":57}},{"generated":{"line":124,"column":80},"source":"index.js","original":{"line":110,"column":2}},{"generated":{"line":124,"column":82},"source":"index.js","original":{"line":111,"column":74}},{"generated":{"line":125,"column":0},"source":"index.js","original":{"line":112,"column":4}},{"name":"allGradients","generated":{"line":125,"column":10},"source":"index.js","original":{"line":112,"column":10}},{"generated":{"line":125,"column":22},"source":"index.js","original":{"line":112,"column":22}},{"generated":{"line":125,"column":25},"source":"index.js","original":{"line":112,"column":25}},{"generated":{"line":125,"column":27},"source":"index.js","original":{"line":112,"column":4}},{"generated":{"line":126,"column":0},"source":"index.js","original":{"line":113,"column":4}},{"name":"allRewards","generated":{"line":126,"column":10},"source":"index.js","original":{"line":113,"column":10}},{"generated":{"line":126,"column":20},"source":"index.js","original":{"line":113,"column":20}},{"generated":{"line":126,"column":23},"source":"index.js","original":{"line":113,"column":23}},{"generated":{"line":126,"column":25},"source":"index.js","original":{"line":113,"column":4}},{"generated":{"line":127,"column":0},"source":"index.js","original":{"line":114,"column":4}},{"name":"gameSteps","generated":{"line":127,"column":10},"source":"index.js","original":{"line":114,"column":10}},{"generated":{"line":127,"column":19},"source":"index.js","original":{"line":114,"column":19}},{"generated":{"line":127,"column":22},"source":"index.js","original":{"line":114,"column":22}},{"generated":{"line":127,"column":24},"source":"index.js","original":{"line":114,"column":4}},{"generated":{"line":128,"column":0},"source":"index.js","original":{"line":115,"column":4}},{"generated":{"line":128,"column":23},"source":"index.js","original":{"line":115,"column":14}},{"generated":{"line":128,"column":24},"source":"index.js","original":{"line":115,"column":4}},{"name":"numGames","generated":{"line":128,"column":26},"source":"index.js","original":{"line":115,"column":17}},{"generated":{"line":128,"column":34},"source":"index.js","original":{"line":115,"column":4}},{"generated":{"line":130,"column":0},"source":"index.js","original":{"line":116,"column":4}},{"generated":{"line":130,"column":9},"source":"index.js","original":{"line":116,"column":9}},{"name":"i","generated":{"line":130,"column":13},"source":"index.js","original":{"line":116,"column":13}},{"generated":{"line":130,"column":14},"source":"index.js","original":{"line":116,"column":14}},{"generated":{"line":130,"column":17},"source":"index.js","original":{"line":116,"column":17}},{"generated":{"line":130,"column":18},"source":"index.js","original":{"line":116,"column":4}},{"name":"i","generated":{"line":130,"column":20},"source":"index.js","original":{"line":116,"column":20}},{"generated":{"line":130,"column":21},"source":"index.js","original":{"line":116,"column":21}},{"name":"numGames","generated":{"line":130,"column":24},"source":"index.js","original":{"line":116,"column":24}},{"generated":{"line":130,"column":32},"source":"index.js","original":{"line":116,"column":4}},{"generated":{"line":130,"column":34},"source":"index.js","original":{"line":116,"column":34}},{"name":"i","generated":{"line":130,"column":36},"source":"index.js","original":{"line":116,"column":36}},{"generated":{"line":130,"column":37},"source":"index.js","original":{"line":116,"column":4}},{"generated":{"line":130,"column":39},"source":"index.js","original":{"line":116,"column":39}},{"generated":{"line":131,"column":0},"source":"index.js","original":{"line":117,"column":6}},{"generated":{"line":132,"column":0},"source":"index.js","original":{"line":118,"column":6}},{"name":"cartPoleSystem","generated":{"line":133,"column":0},"source":"index.js","original":{"line":119,"column":6}},{"name":"cartPoleSystem","generated":{"line":133,"column":6},"source":"index.js","original":{"line":119,"column":6}},{"generated":{"line":133,"column":20},"source":"index.js","original":{"line":119,"column":20}},{"name":"setRandomState","generated":{"line":133,"column":21},"source":"index.js","original":{"line":119,"column":21}},{"generated":{"line":133,"column":35},"source":"index.js","original":{"line":119,"column":6}},{"generated":{"line":134,"column":0},"source":"index.js","original":{"line":120,"column":6}},{"name":"gameRewards","generated":{"line":134,"column":12},"source":"index.js","original":{"line":120,"column":12}},{"generated":{"line":134,"column":23},"source":"index.js","original":{"line":120,"column":23}},{"generated":{"line":134,"column":26},"source":"index.js","original":{"line":120,"column":26}},{"generated":{"line":134,"column":28},"source":"index.js","original":{"line":120,"column":6}},{"generated":{"line":135,"column":0},"source":"index.js","original":{"line":121,"column":6}},{"name":"gameGradients","generated":{"line":135,"column":12},"source":"index.js","original":{"line":121,"column":12}},{"generated":{"line":135,"column":25},"source":"index.js","original":{"line":121,"column":25}},{"generated":{"line":135,"column":28},"source":"index.js","original":{"line":121,"column":28}},{"generated":{"line":135,"column":30},"source":"index.js","original":{"line":121,"column":6}},{"generated":{"line":137,"column":0},"source":"index.js","original":{"line":122,"column":6}},{"generated":{"line":137,"column":11},"source":"index.js","original":{"line":122,"column":11}},{"name":"j","generated":{"line":137,"column":15},"source":"index.js","original":{"line":122,"column":15}},{"generated":{"line":137,"column":16},"source":"index.js","original":{"line":122,"column":16}},{"generated":{"line":137,"column":19},"source":"index.js","original":{"line":122,"column":19}},{"generated":{"line":137,"column":20},"source":"index.js","original":{"line":122,"column":6}},{"name":"j","generated":{"line":137,"column":22},"source":"index.js","original":{"line":122,"column":22}},{"generated":{"line":137,"column":23},"source":"index.js","original":{"line":122,"column":23}},{"name":"maxStepsPerGame","generated":{"line":137,"column":26},"source":"index.js","original":{"line":122,"column":26}},{"generated":{"line":137,"column":41},"source":"index.js","original":{"line":122,"column":6}},{"generated":{"line":137,"column":43},"source":"index.js","original":{"line":122,"column":43}},{"name":"j","generated":{"line":137,"column":45},"source":"index.js","original":{"line":122,"column":45}},{"generated":{"line":137,"column":46},"source":"index.js","original":{"line":122,"column":6}},{"generated":{"line":137,"column":48},"source":"index.js","original":{"line":122,"column":48}},{"generated":{"line":138,"column":0},"source":"index.js","original":{"line":123,"column":8}},{"generated":{"line":139,"column":0},"source":"index.js","original":{"line":124,"column":8}},{"generated":{"line":140,"column":0},"source":"index.js","original":{"line":125,"column":8}},{"generated":{"line":141,"column":0},"source":"index.js","original":{"line":126,"column":8}},{"name":"gradients","generated":{"line":141,"column":14},"source":"index.js","original":{"line":126,"column":14}},{"generated":{"line":141,"column":23},"source":"index.js","original":{"line":126,"column":23}},{"name":"tf","generated":{"line":141,"column":26},"source":"index.js","original":{"line":126,"column":26}},{"generated":{"line":141,"column":28},"source":"index.js","original":{"line":126,"column":28}},{"name":"tidy","generated":{"line":141,"column":29},"source":"index.js","original":{"line":126,"column":29}},{"generated":{"line":141,"column":33},"source":"index.js","original":{"line":126,"column":26}},{"generated":{"line":141,"column":34},"source":"index.js","original":{"line":126,"column":34}},{"generated":{"line":141,"column":40},"source":"index.js","original":{"line":126,"column":40}},{"generated":{"line":142,"column":0},"source":"index.js","original":{"line":127,"column":10}},{"name":"inputTensor","generated":{"line":142,"column":16},"source":"index.js","original":{"line":127,"column":16}},{"generated":{"line":142,"column":27},"source":"index.js","original":{"line":127,"column":27}},{"name":"cartPoleSystem","generated":{"line":142,"column":30},"source":"index.js","original":{"line":127,"column":30}},{"generated":{"line":142,"column":44},"source":"index.js","original":{"line":127,"column":44}},{"name":"getStateTensor","generated":{"line":142,"column":45},"source":"index.js","original":{"line":127,"column":45}},{"generated":{"line":142,"column":59},"source":"index.js","original":{"line":127,"column":30}},{"generated":{"line":142,"column":61},"source":"index.js","original":{"line":127,"column":10}},{"generated":{"line":143,"column":0},"source":"index.js","original":{"line":128,"column":10}},{"generated":{"line":143,"column":17},"source":"index.js","original":{"line":128,"column":17}},{"name":"getGradientsAndSaveActions","generated":{"line":143,"column":22},"source":"index.js","original":{"line":128,"column":22}},{"generated":{"line":143,"column":48},"source":"index.js","original":{"line":128,"column":17}},{"name":"inputTensor","generated":{"line":143,"column":49},"source":"index.js","original":{"line":128,"column":49}},{"generated":{"line":143,"column":60},"source":"index.js","original":{"line":128,"column":17}},{"name":"grads","generated":{"line":143,"column":62},"source":"index.js","original":{"line":128,"column":62}},{"generated":{"line":143,"column":67},"source":"index.js","original":{"line":128,"column":10}},{"generated":{"line":144,"column":0},"source":"index.js","original":{"line":129,"column":9}},{"generated":{"line":144,"column":9},"source":"index.js","original":{"line":126,"column":26}},{"generated":{"line":144,"column":10},"source":"index.js","original":{"line":126,"column":8}},{"generated":{"line":145,"column":0},"source":"index.js","original":{"line":131,"column":8}},{"name":"pushGradients","generated":{"line":145,"column":13},"source":"index.js","original":{"line":131,"column":13}},{"generated":{"line":145,"column":26},"source":"index.js","original":{"line":131,"column":8}},{"name":"gameGradients","generated":{"line":145,"column":27},"source":"index.js","original":{"line":131,"column":27}},{"generated":{"line":145,"column":40},"source":"index.js","original":{"line":131,"column":8}},{"name":"gradients","generated":{"line":145,"column":42},"source":"index.js","original":{"line":131,"column":42}},{"generated":{"line":145,"column":51},"source":"index.js","original":{"line":131,"column":8}},{"generated":{"line":146,"column":0},"source":"index.js","original":{"line":132,"column":8}},{"name":"action","generated":{"line":146,"column":14},"source":"index.js","original":{"line":132,"column":14}},{"generated":{"line":146,"column":20},"source":"index.js","original":{"line":132,"column":20}},{"generated":{"line":146,"column":23},"source":"index.js","original":{"line":132,"column":23}},{"name":"currentActions_","generated":{"line":146,"column":28},"source":"index.js","original":{"line":132,"column":28}},{"generated":{"line":146,"column":43},"source":"index.js","original":{"line":132,"column":23}},{"generated":{"line":146,"column":44},"source":"index.js","original":{"line":132,"column":44}},{"generated":{"line":146,"column":45},"source":"index.js","original":{"line":132,"column":23}},{"generated":{"line":146,"column":46},"source":"index.js","original":{"line":132,"column":8}},{"generated":{"line":147,"column":0},"source":"index.js","original":{"line":133,"column":8}},{"name":"isDone","generated":{"line":147,"column":14},"source":"index.js","original":{"line":133,"column":14}},{"generated":{"line":147,"column":20},"source":"index.js","original":{"line":133,"column":20}},{"name":"cartPoleSystem","generated":{"line":147,"column":23},"source":"index.js","original":{"line":133,"column":23}},{"generated":{"line":147,"column":37},"source":"index.js","original":{"line":133,"column":37}},{"name":"update","generated":{"line":147,"column":38},"source":"index.js","original":{"line":133,"column":38}},{"generated":{"line":147,"column":44},"source":"index.js","original":{"line":133,"column":23}},{"name":"action","generated":{"line":147,"column":45},"source":"index.js","original":{"line":133,"column":45}},{"generated":{"line":147,"column":51},"source":"index.js","original":{"line":133,"column":23}},{"generated":{"line":147,"column":52},"source":"index.js","original":{"line":133,"column":8}},{"generated":{"line":148,"column":0},"source":"index.js","original":{"line":135,"column":8}},{"generated":{"line":148,"column":14},"source":"index.js","original":{"line":135,"column":14}},{"name":"cartPoleSystem","generated":{"line":148,"column":49},"source":"index.js","original":{"line":135,"column":40}},{"generated":{"line":148,"column":63},"source":"index.js","original":{"line":135,"column":14}},{"generated":{"line":148,"column":64},"source":"index.js","original":{"line":135,"column":8}},{"generated":{"line":150,"column":0},"source":"index.js","original":{"line":137,"column":8}},{"name":"isDone","generated":{"line":150,"column":12},"source":"index.js","original":{"line":137,"column":12}},{"generated":{"line":150,"column":18},"source":"index.js","original":{"line":137,"column":8}},{"generated":{"line":150,"column":20},"source":"index.js","original":{"line":137,"column":20}},{"generated":{"line":151,"column":0},"source":"index.js","original":{"line":138,"column":10}},{"generated":{"line":152,"column":0},"source":"index.js","original":{"line":139,"column":10}},{"name":"gameRewards","generated":{"line":153,"column":0},"source":"index.js","original":{"line":140,"column":10}},{"name":"gameRewards","generated":{"line":153,"column":10},"source":"index.js","original":{"line":140,"column":10}},{"generated":{"line":153,"column":21},"source":"index.js","original":{"line":140,"column":21}},{"name":"push","generated":{"line":153,"column":22},"source":"index.js","original":{"line":140,"column":22}},{"generated":{"line":153,"column":26},"source":"index.js","original":{"line":140,"column":10}},{"generated":{"line":153,"column":27},"source":"index.js","original":{"line":140,"column":27}},{"generated":{"line":153,"column":28},"source":"index.js","original":{"line":140,"column":10}},{"generated":{"line":154,"column":0},"source":"index.js","original":{"line":141,"column":10}},{"generated":{"line":155,"column":0},"source":"index.js","original":{"line":142,"column":9}},{"generated":{"line":155,"column":9},"source":"index.js","original":{"line":137,"column":8}},{"generated":{"line":155,"column":15},"source":"index.js","original":{"line":142,"column":15}},{"generated":{"line":156,"column":0},"source":"index.js","original":{"line":143,"column":10}},{"generated":{"line":157,"column":0},"source":"index.js","original":{"line":144,"column":10}},{"generated":{"line":158,"column":0},"source":"index.js","original":{"line":145,"column":10}},{"name":"gameRewards","generated":{"line":159,"column":0},"source":"index.js","original":{"line":146,"column":10}},{"name":"gameRewards","generated":{"line":159,"column":10},"source":"index.js","original":{"line":146,"column":10}},{"generated":{"line":159,"column":21},"source":"index.js","original":{"line":146,"column":21}},{"name":"push","generated":{"line":159,"column":22},"source":"index.js","original":{"line":146,"column":22}},{"generated":{"line":159,"column":26},"source":"index.js","original":{"line":146,"column":10}},{"generated":{"line":159,"column":27},"source":"index.js","original":{"line":146,"column":27}},{"generated":{"line":159,"column":28},"source":"index.js","original":{"line":146,"column":10}},{"generated":{"line":160,"column":0},"source":"index.js","original":{"line":147,"column":9}},{"generated":{"line":161,"column":0},"source":"index.js","original":{"line":148,"column":7}},{"generated":{"line":163,"column":0},"source":"index.js","original":{"line":149,"column":6}},{"name":"i","generated":{"line":163,"column":25},"source":"index.js","original":{"line":149,"column":16}},{"generated":{"line":163,"column":26},"source":"index.js","original":{"line":149,"column":17}},{"generated":{"line":163,"column":29},"source":"index.js","original":{"line":149,"column":20}},{"generated":{"line":163,"column":30},"source":"index.js","original":{"line":149,"column":6}},{"name":"numGames","generated":{"line":163,"column":32},"source":"index.js","original":{"line":149,"column":23}},{"generated":{"line":163,"column":40},"source":"index.js","original":{"line":149,"column":6}},{"name":"gameSteps","generated":{"line":164,"column":0},"source":"index.js","original":{"line":150,"column":6}},{"name":"gameSteps","generated":{"line":164,"column":6},"source":"index.js","original":{"line":150,"column":6}},{"generated":{"line":164,"column":15},"source":"index.js","original":{"line":150,"column":15}},{"name":"push","generated":{"line":164,"column":16},"source":"index.js","original":{"line":150,"column":16}},{"generated":{"line":164,"column":20},"source":"index.js","original":{"line":150,"column":6}},{"name":"gameRewards","generated":{"line":164,"column":21},"source":"index.js","original":{"line":150,"column":21}},{"generated":{"line":164,"column":32},"source":"index.js","original":{"line":150,"column":32}},{"name":"length","generated":{"line":164,"column":33},"source":"index.js","original":{"line":150,"column":33}},{"generated":{"line":164,"column":39},"source":"index.js","original":{"line":150,"column":6}},{"generated":{"line":165,"column":0},"source":"index.js","original":{"line":151,"column":6}},{"name":"pushGradients","generated":{"line":165,"column":11},"source":"index.js","original":{"line":151,"column":11}},{"generated":{"line":165,"column":24},"source":"index.js","original":{"line":151,"column":6}},{"name":"allGradients","generated":{"line":165,"column":25},"source":"index.js","original":{"line":151,"column":25}},{"generated":{"line":165,"column":37},"source":"index.js","original":{"line":151,"column":6}},{"name":"gameGradients","generated":{"line":165,"column":39},"source":"index.js","original":{"line":151,"column":39}},{"generated":{"line":165,"column":52},"source":"index.js","original":{"line":151,"column":6}},{"name":"allRewards","generated":{"line":166,"column":0},"source":"index.js","original":{"line":152,"column":6}},{"name":"allRewards","generated":{"line":166,"column":6},"source":"index.js","original":{"line":152,"column":6}},{"generated":{"line":166,"column":16},"source":"index.js","original":{"line":152,"column":16}},{"name":"push","generated":{"line":166,"column":17},"source":"index.js","original":{"line":152,"column":17}},{"generated":{"line":166,"column":21},"source":"index.js","original":{"line":152,"column":6}},{"name":"gameRewards","generated":{"line":166,"column":22},"source":"index.js","original":{"line":152,"column":22}},{"generated":{"line":166,"column":33},"source":"index.js","original":{"line":152,"column":6}},{"generated":{"line":167,"column":0},"source":"index.js","original":{"line":153,"column":6}},{"name":"tf","generated":{"line":167,"column":12},"source":"index.js","original":{"line":153,"column":12}},{"generated":{"line":167,"column":14},"source":"index.js","original":{"line":153,"column":14}},{"name":"nextFrame","generated":{"line":167,"column":15},"source":"index.js","original":{"line":153,"column":15}},{"generated":{"line":167,"column":24},"source":"index.js","original":{"line":153,"column":12}},{"generated":{"line":167,"column":26},"source":"index.js","original":{"line":153,"column":6}},{"generated":{"line":168,"column":0},"source":"index.js","original":{"line":154,"column":5}},{"name":"tf","generated":{"line":170,"column":0},"source":"index.js","original":{"line":156,"column":4}},{"name":"tf","generated":{"line":170,"column":4},"source":"index.js","original":{"line":156,"column":4}},{"generated":{"line":170,"column":6},"source":"index.js","original":{"line":156,"column":6}},{"name":"tidy","generated":{"line":170,"column":7},"source":"index.js","original":{"line":156,"column":7}},{"generated":{"line":170,"column":11},"source":"index.js","original":{"line":156,"column":4}},{"generated":{"line":170,"column":12},"source":"index.js","original":{"line":156,"column":12}},{"generated":{"line":170,"column":18},"source":"index.js","original":{"line":156,"column":18}},{"generated":{"line":171,"column":0},"source":"index.js","original":{"line":157,"column":6}},{"generated":{"line":172,"column":0},"source":"index.js","original":{"line":158,"column":6}},{"generated":{"line":173,"column":0},"source":"index.js","original":{"line":159,"column":6}},{"generated":{"line":174,"column":0},"source":"index.js","original":{"line":160,"column":6}},{"generated":{"line":175,"column":0},"source":"index.js","original":{"line":161,"column":6}},{"generated":{"line":176,"column":0},"source":"index.js","original":{"line":162,"column":6}},{"generated":{"line":177,"column":0},"source":"index.js","original":{"line":163,"column":6}},{"generated":{"line":178,"column":0},"source":"index.js","original":{"line":164,"column":6}},{"generated":{"line":179,"column":0},"source":"index.js","original":{"line":165,"column":6}},{"generated":{"line":180,"column":0},"source":"index.js","original":{"line":166,"column":6}},{"generated":{"line":181,"column":0},"source":"index.js","original":{"line":167,"column":6}},{"generated":{"line":182,"column":0},"source":"index.js","original":{"line":168,"column":6}},{"name":"normalizedRewards","generated":{"line":182,"column":12},"source":"index.js","original":{"line":168,"column":12}},{"generated":{"line":182,"column":29},"source":"index.js","original":{"line":168,"column":29}},{"name":"discountAndNormalizeRewards","generated":{"line":182,"column":32},"source":"index.js","original":{"line":169,"column":10}},{"generated":{"line":182,"column":59},"source":"index.js","original":{"line":169,"column":37}},{"name":"allRewards","generated":{"line":182,"column":60},"source":"index.js","original":{"line":169,"column":38}},{"generated":{"line":182,"column":70},"source":"index.js","original":{"line":169,"column":37}},{"name":"discountRate","generated":{"line":182,"column":72},"source":"index.js","original":{"line":169,"column":50}},{"generated":{"line":182,"column":84},"source":"index.js","original":{"line":169,"column":37}},{"generated":{"line":182,"column":85},"source":"index.js","original":{"line":168,"column":6}},{"generated":{"line":182,"column":86},"source":"index.js","original":{"line":156,"column":18}},{"generated":{"line":182,"column":87},"source":"index.js","original":{"line":170,"column":6}},{"generated":{"line":183,"column":0},"source":"index.js","original":{"line":171,"column":6}},{"generated":{"line":184,"column":0},"source":"index.js","original":{"line":172,"column":6}},{"generated":{"line":185,"column":0},"source":"index.js","original":{"line":173,"column":6}},{"name":"optimizer","generated":{"line":187,"column":0},"source":"index.js","original":{"line":174,"column":6}},{"name":"optimizer","generated":{"line":187,"column":6},"source":"index.js","original":{"line":174,"column":6}},{"generated":{"line":187,"column":15},"source":"index.js","original":{"line":174,"column":15}},{"name":"applyGradients","generated":{"line":187,"column":16},"source":"index.js","original":{"line":174,"column":16}},{"generated":{"line":187,"column":30},"source":"index.js","original":{"line":174,"column":6}},{"name":"scaleAndAverageGradients","generated":{"line":187,"column":31},"source":"index.js","original":{"line":175,"column":10}},{"generated":{"line":187,"column":55},"source":"index.js","original":{"line":175,"column":34}},{"name":"allGradients","generated":{"line":187,"column":56},"source":"index.js","original":{"line":175,"column":35}},{"generated":{"line":187,"column":68},"source":"index.js","original":{"line":175,"column":34}},{"name":"normalizedRewards","generated":{"line":187,"column":70},"source":"index.js","original":{"line":175,"column":49}},{"generated":{"line":187,"column":87},"source":"index.js","original":{"line":175,"column":34}},{"generated":{"line":187,"column":88},"source":"index.js","original":{"line":174,"column":6}},{"generated":{"line":188,"column":0},"source":"index.js","original":{"line":176,"column":5}},{"generated":{"line":188,"column":5},"source":"index.js","original":{"line":156,"column":4}},{"name":"tf","generated":{"line":189,"column":0},"source":"index.js","original":{"line":177,"column":4}},{"name":"tf","generated":{"line":189,"column":4},"source":"index.js","original":{"line":177,"column":4}},{"generated":{"line":189,"column":6},"source":"index.js","original":{"line":177,"column":6}},{"name":"dispose","generated":{"line":189,"column":7},"source":"index.js","original":{"line":177,"column":7}},{"generated":{"line":189,"column":14},"source":"index.js","original":{"line":177,"column":4}},{"name":"allGradients","generated":{"line":189,"column":15},"source":"index.js","original":{"line":177,"column":15}},{"generated":{"line":189,"column":27},"source":"index.js","original":{"line":177,"column":4}},{"generated":{"line":190,"column":0},"source":"index.js","original":{"line":178,"column":4}},{"name":"gameSteps","generated":{"line":190,"column":11},"source":"index.js","original":{"line":178,"column":11}},{"generated":{"line":190,"column":20},"source":"index.js","original":{"line":178,"column":4}},{"generated":{"line":191,"column":0},"source":"index.js","original":{"line":179,"column":3}},{"name":"getGradientsAndSaveActions","generated":{"line":193,"column":0},"source":"index.js","original":{"line":181,"column":2}},{"name":"getGradientsAndSaveActions","generated":{"line":193,"column":2},"source":"index.js","original":{"line":181,"column":2}},{"generated":{"line":193,"column":28},"source":"index.js","original":{"line":181,"column":28}},{"name":"inputTensor","generated":{"line":193,"column":29},"source":"index.js","original":{"line":181,"column":29}},{"generated":{"line":193,"column":40},"source":"index.js","original":{"line":181,"column":28}},{"generated":{"line":193,"column":42},"source":"index.js","original":{"line":181,"column":42}},{"generated":{"line":194,"column":0},"source":"index.js","original":{"line":182,"column":4}},{"name":"f","generated":{"line":194,"column":10},"source":"index.js","original":{"line":182,"column":10}},{"generated":{"line":194,"column":11},"source":"index.js","original":{"line":182,"column":11}},{"generated":{"line":194,"column":14},"source":"index.js","original":{"line":182,"column":14}},{"name":"tf","generated":{"line":194,"column":20},"source":"index.js","original":{"line":182,"column":20}},{"generated":{"line":194,"column":22},"source":"index.js","original":{"line":182,"column":22}},{"name":"tidy","generated":{"line":194,"column":23},"source":"index.js","original":{"line":182,"column":23}},{"generated":{"line":194,"column":27},"source":"index.js","original":{"line":182,"column":20}},{"generated":{"line":194,"column":28},"source":"index.js","original":{"line":182,"column":28}},{"generated":{"line":194,"column":34},"source":"index.js","original":{"line":182,"column":34}},{"generated":{"line":195,"column":0},"source":"index.js","original":{"line":183,"column":6}},{"generated":{"line":195,"column":12},"source":"index.js","original":{"line":183,"column":12}},{"name":"logits","generated":{"line":195,"column":13},"source":"index.js","original":{"line":183,"column":13}},{"generated":{"line":195,"column":19},"source":"index.js","original":{"line":183,"column":12}},{"name":"actions","generated":{"line":195,"column":21},"source":"index.js","original":{"line":183,"column":21}},{"generated":{"line":195,"column":28},"source":"index.js","original":{"line":183,"column":12}},{"generated":{"line":195,"column":32},"source":"index.js","original":{"line":183,"column":32}},{"name":"getLogitsAndActions","generated":{"line":195,"column":37},"source":"index.js","original":{"line":183,"column":37}},{"generated":{"line":195,"column":56},"source":"index.js","original":{"line":183,"column":32}},{"name":"inputTensor","generated":{"line":195,"column":57},"source":"index.js","original":{"line":183,"column":57}},{"generated":{"line":195,"column":68},"source":"index.js","original":{"line":183,"column":32}},{"generated":{"line":195,"column":69},"source":"index.js","original":{"line":183,"column":6}},{"generated":{"line":196,"column":0},"source":"index.js","original":{"line":184,"column":6}},{"name":"currentActions_","generated":{"line":196,"column":11},"source":"index.js","original":{"line":184,"column":11}},{"generated":{"line":196,"column":26},"source":"index.js","original":{"line":184,"column":6}},{"name":"actions","generated":{"line":196,"column":29},"source":"index.js","original":{"line":184,"column":29}},{"generated":{"line":196,"column":36},"source":"index.js","original":{"line":184,"column":36}},{"name":"dataSync","generated":{"line":196,"column":37},"source":"index.js","original":{"line":184,"column":37}},{"generated":{"line":196,"column":45},"source":"index.js","original":{"line":184,"column":29}},{"generated":{"line":196,"column":47},"source":"index.js","original":{"line":184,"column":6}},{"generated":{"line":197,"column":0},"source":"index.js","original":{"line":185,"column":6}},{"name":"labels","generated":{"line":197,"column":12},"source":"index.js","original":{"line":185,"column":12}},{"generated":{"line":197,"column":18},"source":"index.js","original":{"line":185,"column":18}},{"name":"tf","generated":{"line":197,"column":21},"source":"index.js","original":{"line":186,"column":10}},{"generated":{"line":197,"column":23},"source":"index.js","original":{"line":186,"column":12}},{"name":"sub","generated":{"line":197,"column":24},"source":"index.js","original":{"line":186,"column":13}},{"generated":{"line":197,"column":27},"source":"index.js","original":{"line":186,"column":10}},{"generated":{"line":197,"column":28},"source":"index.js","original":{"line":186,"column":17}},{"generated":{"line":197,"column":29},"source":"index.js","original":{"line":186,"column":10}},{"name":"tf","generated":{"line":197,"column":31},"source":"index.js","original":{"line":186,"column":20}},{"generated":{"line":197,"column":33},"source":"index.js","original":{"line":186,"column":22}},{"name":"tensor2d","generated":{"line":197,"column":34},"source":"index.js","original":{"line":186,"column":23}},{"generated":{"line":197,"column":42},"source":"index.js","original":{"line":186,"column":20}},{"generated":{"line":197,"column":43},"source":"index.js","original":{"line":186,"column":32}},{"name":"currentActions_","generated":{"line":197,"column":48},"source":"index.js","original":{"line":186,"column":37}},{"generated":{"line":197,"column":63},"source":"index.js","original":{"line":186,"column":20}},{"name":"actions","generated":{"line":197,"column":65},"source":"index.js","original":{"line":186,"column":54}},{"generated":{"line":197,"column":72},"source":"index.js","original":{"line":186,"column":61}},{"name":"shape","generated":{"line":197,"column":73},"source":"index.js","original":{"line":186,"column":62}},{"generated":{"line":197,"column":78},"source":"index.js","original":{"line":186,"column":20}},{"generated":{"line":197,"column":79},"source":"index.js","original":{"line":186,"column":10}},{"generated":{"line":197,"column":80},"source":"index.js","original":{"line":185,"column":6}},{"generated":{"line":198,"column":0},"source":"index.js","original":{"line":187,"column":6}},{"name":"tf","generated":{"line":198,"column":13},"source":"index.js","original":{"line":187,"column":13}},{"generated":{"line":198,"column":15},"source":"index.js","original":{"line":187,"column":15}},{"name":"losses","generated":{"line":198,"column":16},"source":"index.js","original":{"line":187,"column":16}},{"generated":{"line":198,"column":22},"source":"index.js","original":{"line":187,"column":13}},{"name":"sigmoidCrossEntropy","generated":{"line":198,"column":23},"source":"index.js","original":{"line":187,"column":23}},{"generated":{"line":198,"column":42},"source":"index.js","original":{"line":187,"column":13}},{"name":"labels","generated":{"line":198,"column":43},"source":"index.js","original":{"line":187,"column":43}},{"generated":{"line":198,"column":49},"source":"index.js","original":{"line":187,"column":13}},{"name":"logits","generated":{"line":198,"column":51},"source":"index.js","original":{"line":187,"column":51}},{"generated":{"line":198,"column":57},"source":"index.js","original":{"line":187,"column":13}},{"name":"asScalar","generated":{"line":198,"column":59},"source":"index.js","original":{"line":187,"column":59}},{"generated":{"line":198,"column":67},"source":"index.js","original":{"line":187,"column":13}},{"generated":{"line":198,"column":69},"source":"index.js","original":{"line":187,"column":6}},{"generated":{"line":199,"column":0},"source":"index.js","original":{"line":188,"column":5}},{"generated":{"line":199,"column":5},"source":"index.js","original":{"line":182,"column":20}},{"generated":{"line":199,"column":6},"source":"index.js","original":{"line":182,"column":4}},{"generated":{"line":201,"column":0},"source":"index.js","original":{"line":189,"column":4}},{"name":"tf","generated":{"line":201,"column":11},"source":"index.js","original":{"line":189,"column":11}},{"generated":{"line":201,"column":13},"source":"index.js","original":{"line":189,"column":13}},{"name":"variableGrads","generated":{"line":201,"column":14},"source":"index.js","original":{"line":189,"column":14}},{"generated":{"line":201,"column":27},"source":"index.js","original":{"line":189,"column":11}},{"name":"f","generated":{"line":201,"column":28},"source":"index.js","original":{"line":189,"column":28}},{"generated":{"line":201,"column":29},"source":"index.js","original":{"line":189,"column":11}},{"generated":{"line":201,"column":30},"source":"index.js","original":{"line":189,"column":4}},{"generated":{"line":202,"column":0},"source":"index.js","original":{"line":190,"column":3}},{"name":"getCurrentActions","generated":{"line":204,"column":0},"source":"index.js","original":{"line":192,"column":2}},{"name":"getCurrentActions","generated":{"line":204,"column":2},"source":"index.js","original":{"line":192,"column":2}},{"generated":{"line":204,"column":19},"source":"index.js","original":{"line":192,"column":19}},{"generated":{"line":204,"column":22},"source":"index.js","original":{"line":192,"column":22}},{"generated":{"line":205,"column":0},"source":"index.js","original":{"line":193,"column":4}},{"generated":{"line":205,"column":11},"source":"index.js","original":{"line":193,"column":11}},{"name":"currentActions_","generated":{"line":205,"column":16},"source":"index.js","original":{"line":193,"column":16}},{"generated":{"line":205,"column":31},"source":"index.js","original":{"line":193,"column":4}},{"generated":{"line":206,"column":0},"source":"index.js","original":{"line":194,"column":3}},{"generated":{"line":207,"column":0},"source":"index.js","original":{"line":196,"column":2}},{"name":"getLogitsAndActions","generated":{"line":217,"column":0},"source":"index.js","original":{"line":204,"column":2}},{"name":"getLogitsAndActions","generated":{"line":217,"column":2},"source":"index.js","original":{"line":204,"column":2}},{"generated":{"line":217,"column":21},"source":"index.js","original":{"line":204,"column":21}},{"name":"inputs","generated":{"line":217,"column":22},"source":"index.js","original":{"line":204,"column":22}},{"generated":{"line":217,"column":28},"source":"index.js","original":{"line":204,"column":21}},{"generated":{"line":217,"column":30},"source":"index.js","original":{"line":204,"column":30}},{"generated":{"line":218,"column":0},"source":"index.js","original":{"line":205,"column":4}},{"name":"tf","generated":{"line":218,"column":11},"source":"index.js","original":{"line":205,"column":11}},{"generated":{"line":218,"column":13},"source":"index.js","original":{"line":205,"column":13}},{"name":"tidy","generated":{"line":218,"column":14},"source":"index.js","original":{"line":205,"column":14}},{"generated":{"line":218,"column":18},"source":"index.js","original":{"line":205,"column":11}},{"generated":{"line":218,"column":19},"source":"index.js","original":{"line":205,"column":19}},{"generated":{"line":218,"column":25},"source":"index.js","original":{"line":205,"column":25}},{"generated":{"line":219,"column":0},"source":"index.js","original":{"line":206,"column":6}},{"name":"logits","generated":{"line":219,"column":12},"source":"index.js","original":{"line":206,"column":12}},{"generated":{"line":219,"column":18},"source":"index.js","original":{"line":206,"column":18}},{"generated":{"line":219,"column":21},"source":"index.js","original":{"line":206,"column":21}},{"name":"model","generated":{"line":219,"column":26},"source":"index.js","original":{"line":206,"column":26}},{"generated":{"line":219,"column":31},"source":"index.js","original":{"line":206,"column":21}},{"name":"predict","generated":{"line":219,"column":32},"source":"index.js","original":{"line":206,"column":32}},{"generated":{"line":219,"column":39},"source":"index.js","original":{"line":206,"column":21}},{"name":"inputs","generated":{"line":219,"column":40},"source":"index.js","original":{"line":206,"column":40}},{"generated":{"line":219,"column":46},"source":"index.js","original":{"line":206,"column":21}},{"generated":{"line":219,"column":47},"source":"index.js","original":{"line":206,"column":6}},{"generated":{"line":219,"column":48},"source":"index.js","original":{"line":205,"column":25}},{"generated":{"line":219,"column":49},"source":"index.js","original":{"line":208,"column":6}},{"generated":{"line":221,"column":0},"source":"index.js","original":{"line":209,"column":6}},{"name":"leftProb","generated":{"line":221,"column":12},"source":"index.js","original":{"line":209,"column":12}},{"generated":{"line":221,"column":20},"source":"index.js","original":{"line":209,"column":20}},{"name":"tf","generated":{"line":221,"column":23},"source":"index.js","original":{"line":209,"column":23}},{"generated":{"line":221,"column":25},"source":"index.js","original":{"line":209,"column":25}},{"name":"sigmoid","generated":{"line":221,"column":26},"source":"index.js","original":{"line":209,"column":26}},{"generated":{"line":221,"column":33},"source":"index.js","original":{"line":209,"column":23}},{"name":"logits","generated":{"line":221,"column":34},"source":"index.js","original":{"line":209,"column":34}},{"generated":{"line":221,"column":40},"source":"index.js","original":{"line":209,"column":23}},{"generated":{"line":221,"column":41},"source":"index.js","original":{"line":209,"column":6}},{"generated":{"line":221,"column":42},"source":"index.js","original":{"line":205,"column":25}},{"generated":{"line":221,"column":43},"source":"index.js","original":{"line":210,"column":6}},{"generated":{"line":223,"column":0},"source":"index.js","original":{"line":211,"column":6}},{"name":"leftRightProbs","generated":{"line":223,"column":12},"source":"index.js","original":{"line":211,"column":12}},{"generated":{"line":223,"column":26},"source":"index.js","original":{"line":211,"column":26}},{"name":"tf","generated":{"line":223,"column":29},"source":"index.js","original":{"line":211,"column":29}},{"generated":{"line":223,"column":31},"source":"index.js","original":{"line":211,"column":31}},{"name":"concat","generated":{"line":223,"column":32},"source":"index.js","original":{"line":211,"column":32}},{"generated":{"line":223,"column":38},"source":"index.js","original":{"line":211,"column":29}},{"generated":{"line":223,"column":39},"source":"index.js","original":{"line":211,"column":39}},{"name":"leftProb","generated":{"line":223,"column":40},"source":"index.js","original":{"line":211,"column":40}},{"generated":{"line":223,"column":48},"source":"index.js","original":{"line":211,"column":39}},{"name":"tf","generated":{"line":223,"column":50},"source":"index.js","original":{"line":211,"column":50}},{"generated":{"line":223,"column":52},"source":"index.js","original":{"line":211,"column":52}},{"name":"sub","generated":{"line":223,"column":53},"source":"index.js","original":{"line":211,"column":53}},{"generated":{"line":223,"column":56},"source":"index.js","original":{"line":211,"column":50}},{"generated":{"line":223,"column":57},"source":"index.js","original":{"line":211,"column":57}},{"generated":{"line":223,"column":58},"source":"index.js","original":{"line":211,"column":50}},{"name":"leftProb","generated":{"line":223,"column":60},"source":"index.js","original":{"line":211,"column":60}},{"generated":{"line":223,"column":68},"source":"index.js","original":{"line":211,"column":50}},{"generated":{"line":223,"column":69},"source":"index.js","original":{"line":211,"column":39}},{"generated":{"line":223,"column":70},"source":"index.js","original":{"line":211,"column":29}},{"generated":{"line":223,"column":72},"source":"index.js","original":{"line":211,"column":72}},{"generated":{"line":223,"column":73},"source":"index.js","original":{"line":211,"column":29}},{"generated":{"line":223,"column":74},"source":"index.js","original":{"line":211,"column":6}},{"generated":{"line":224,"column":0},"source":"index.js","original":{"line":212,"column":6}},{"name":"actions","generated":{"line":224,"column":12},"source":"index.js","original":{"line":212,"column":12}},{"generated":{"line":224,"column":19},"source":"index.js","original":{"line":212,"column":19}},{"name":"tf","generated":{"line":224,"column":22},"source":"index.js","original":{"line":212,"column":22}},{"generated":{"line":224,"column":24},"source":"index.js","original":{"line":212,"column":24}},{"name":"multinomial","generated":{"line":224,"column":25},"source":"index.js","original":{"line":212,"column":25}},{"generated":{"line":224,"column":36},"source":"index.js","original":{"line":212,"column":22}},{"name":"leftRightProbs","generated":{"line":224,"column":37},"source":"index.js","original":{"line":212,"column":37}},{"generated":{"line":224,"column":51},"source":"index.js","original":{"line":212,"column":22}},{"generated":{"line":224,"column":53},"source":"index.js","original":{"line":212,"column":53}},{"generated":{"line":224,"column":54},"source":"index.js","original":{"line":212,"column":22}},{"generated":{"line":224,"column":56},"source":"index.js","original":{"line":212,"column":56}},{"generated":{"line":224,"column":60},"source":"index.js","original":{"line":212,"column":22}},{"generated":{"line":224,"column":62},"source":"index.js","original":{"line":212,"column":62}},{"generated":{"line":224,"column":66},"source":"index.js","original":{"line":212,"column":22}},{"generated":{"line":224,"column":67},"source":"index.js","original":{"line":212,"column":6}},{"generated":{"line":225,"column":0},"source":"index.js","original":{"line":213,"column":6}},{"generated":{"line":225,"column":13},"source":"index.js","original":{"line":213,"column":13}},{"name":"logits","generated":{"line":225,"column":14},"source":"index.js","original":{"line":213,"column":14}},{"generated":{"line":225,"column":20},"source":"index.js","original":{"line":213,"column":13}},{"name":"actions","generated":{"line":225,"column":22},"source":"index.js","original":{"line":213,"column":22}},{"generated":{"line":225,"column":29},"source":"index.js","original":{"line":213,"column":13}},{"generated":{"line":225,"column":30},"source":"index.js","original":{"line":213,"column":6}},{"generated":{"line":226,"column":0},"source":"index.js","original":{"line":214,"column":5}},{"generated":{"line":226,"column":5},"source":"index.js","original":{"line":205,"column":11}},{"generated":{"line":226,"column":6},"source":"index.js","original":{"line":205,"column":4}},{"generated":{"line":227,"column":0},"source":"index.js","original":{"line":215,"column":3}},{"generated":{"line":228,"column":0},"source":"index.js","original":{"line":217,"column":2}},{"name":"getActions","generated":{"line":237,"column":0},"source":"index.js","original":{"line":224,"column":2}},{"name":"getActions","generated":{"line":237,"column":2},"source":"index.js","original":{"line":224,"column":2}},{"generated":{"line":237,"column":12},"source":"index.js","original":{"line":224,"column":12}},{"name":"inputs","generated":{"line":237,"column":13},"source":"index.js","original":{"line":224,"column":13}},{"generated":{"line":237,"column":19},"source":"index.js","original":{"line":224,"column":12}},{"generated":{"line":237,"column":21},"source":"index.js","original":{"line":224,"column":21}},{"generated":{"line":238,"column":0},"source":"index.js","original":{"line":225,"column":4}},{"generated":{"line":238,"column":11},"source":"index.js","original":{"line":225,"column":11}},{"name":"getLogitsAndActions","generated":{"line":238,"column":16},"source":"index.js","original":{"line":225,"column":16}},{"generated":{"line":238,"column":35},"source":"index.js","original":{"line":225,"column":11}},{"name":"inputs","generated":{"line":238,"column":36},"source":"index.js","original":{"line":225,"column":36}},{"generated":{"line":238,"column":42},"source":"index.js","original":{"line":225,"column":11}},{"generated":{"line":238,"column":44},"source":"index.js","original":{"line":225,"column":44}},{"generated":{"line":238,"column":45},"source":"index.js","original":{"line":225,"column":11}},{"name":"dataSync","generated":{"line":238,"column":47},"source":"index.js","original":{"line":225,"column":47}},{"generated":{"line":238,"column":55},"source":"index.js","original":{"line":225,"column":11}},{"generated":{"line":238,"column":57},"source":"index.js","original":{"line":225,"column":4}},{"generated":{"line":239,"column":0},"source":"index.js","original":{"line":226,"column":3}},{"generated":{"line":240,"column":0},"source":"index.js","original":{"line":228,"column":2}},{"name":"pushGradients","generated":{"line":251,"column":0},"source":"index.js","original":{"line":237,"column":2}},{"name":"pushGradients","generated":{"line":251,"column":2},"source":"index.js","original":{"line":237,"column":2}},{"generated":{"line":251,"column":15},"source":"index.js","original":{"line":237,"column":15}},{"name":"record","generated":{"line":251,"column":16},"source":"index.js","original":{"line":237,"column":16}},{"generated":{"line":251,"column":22},"source":"index.js","original":{"line":237,"column":15}},{"name":"gradients","generated":{"line":251,"column":24},"source":"index.js","original":{"line":237,"column":24}},{"generated":{"line":251,"column":33},"source":"index.js","original":{"line":237,"column":15}},{"generated":{"line":251,"column":35},"source":"index.js","original":{"line":237,"column":35}},{"generated":{"line":252,"column":0},"source":"index.js","original":{"line":238,"column":4}},{"generated":{"line":252,"column":9},"source":"index.js","original":{"line":238,"column":9}},{"name":"key","generated":{"line":252,"column":15},"source":"index.js","original":{"line":238,"column":15}},{"generated":{"line":252,"column":18},"source":"index.js","original":{"line":238,"column":4}},{"name":"gradients","generated":{"line":252,"column":22},"source":"index.js","original":{"line":238,"column":22}},{"generated":{"line":252,"column":31},"source":"index.js","original":{"line":238,"column":4}},{"generated":{"line":252,"column":33},"source":"index.js","original":{"line":238,"column":33}},{"generated":{"line":253,"column":0},"source":"index.js","original":{"line":239,"column":6}},{"name":"key","generated":{"line":253,"column":10},"source":"index.js","original":{"line":239,"column":10}},{"generated":{"line":253,"column":13},"source":"index.js","original":{"line":239,"column":13}},{"name":"record","generated":{"line":253,"column":17},"source":"index.js","original":{"line":239,"column":17}},{"generated":{"line":253,"column":23},"source":"index.js","original":{"line":239,"column":6}},{"generated":{"line":253,"column":25},"source":"index.js","original":{"line":239,"column":25}},{"name":"record","generated":{"line":254,"column":0},"source":"index.js","original":{"line":240,"column":8}},{"name":"record","generated":{"line":254,"column":8},"source":"index.js","original":{"line":240,"column":8}},{"generated":{"line":254,"column":14},"source":"index.js","original":{"line":240,"column":14}},{"name":"key","generated":{"line":254,"column":15},"source":"index.js","original":{"line":240,"column":15}},{"generated":{"line":254,"column":18},"source":"index.js","original":{"line":240,"column":14}},{"generated":{"line":254,"column":19},"source":"index.js","original":{"line":240,"column":8}},{"name":"push","generated":{"line":254,"column":20},"source":"index.js","original":{"line":240,"column":20}},{"generated":{"line":254,"column":24},"source":"index.js","original":{"line":240,"column":8}},{"name":"gradients","generated":{"line":254,"column":25},"source":"index.js","original":{"line":240,"column":25}},{"generated":{"line":254,"column":34},"source":"index.js","original":{"line":240,"column":34}},{"name":"key","generated":{"line":254,"column":35},"source":"index.js","original":{"line":240,"column":35}},{"generated":{"line":254,"column":38},"source":"index.js","original":{"line":240,"column":34}},{"generated":{"line":254,"column":39},"source":"index.js","original":{"line":240,"column":8}},{"generated":{"line":255,"column":0},"source":"index.js","original":{"line":241,"column":7}},{"generated":{"line":255,"column":7},"source":"index.js","original":{"line":239,"column":6}},{"generated":{"line":255,"column":13},"source":"index.js","original":{"line":241,"column":13}},{"name":"record","generated":{"line":256,"column":0},"source":"index.js","original":{"line":242,"column":8}},{"name":"record","generated":{"line":256,"column":8},"source":"index.js","original":{"line":242,"column":8}},{"generated":{"line":256,"column":14},"source":"index.js","original":{"line":242,"column":14}},{"name":"key","generated":{"line":256,"column":15},"source":"index.js","original":{"line":242,"column":15}},{"generated":{"line":256,"column":18},"source":"index.js","original":{"line":242,"column":14}},{"generated":{"line":256,"column":19},"source":"index.js","original":{"line":242,"column":8}},{"generated":{"line":256,"column":22},"source":"index.js","original":{"line":242,"column":22}},{"name":"gradients","generated":{"line":256,"column":23},"source":"index.js","original":{"line":242,"column":23}},{"generated":{"line":256,"column":32},"source":"index.js","original":{"line":242,"column":32}},{"name":"key","generated":{"line":256,"column":33},"source":"index.js","original":{"line":242,"column":33}},{"generated":{"line":256,"column":36},"source":"index.js","original":{"line":242,"column":32}},{"generated":{"line":256,"column":37},"source":"index.js","original":{"line":242,"column":22}},{"generated":{"line":256,"column":38},"source":"index.js","original":{"line":242,"column":8}},{"generated":{"line":257,"column":0},"source":"index.js","original":{"line":243,"column":7}},{"generated":{"line":258,"column":0},"source":"index.js","original":{"line":244,"column":5}},{"generated":{"line":259,"column":0},"source":"index.js","original":{"line":245,"column":3}},{"generated":{"line":261,"column":0},"source":"index.js","original":{"line":50,"column":20}},{"generated":{"line":261,"column":2},"source":"index.js","original":{"line":248,"column":0}},{"generated":{"line":264,"column":0},"source":"index.js","original":{"line":249,"column":0}},{"name":"MODEL_SAVE_PATH_","generated":{"line":264,"column":6},"source":"index.js","original":{"line":249,"column":6}},{"generated":{"line":264,"column":22},"source":"index.js","original":{"line":249,"column":22}},{"generated":{"line":264,"column":25},"source":"index.js","original":{"line":249,"column":25}},{"generated":{"line":264,"column":51},"source":"index.js","original":{"line":249,"column":0}},{"generated":{"line":265,"column":0},"source":"index.js","original":{"line":251,"column":0}},{"generated":{"line":269,"column":0},"source":"index.js","original":{"line":254,"column":7}},{"name":"SaveablePolicyNetwork","generated":{"line":269,"column":6},"source":"index.js","original":{"line":254,"column":13}},{"generated":{"line":269,"column":27},"source":"index.js","original":{"line":254,"column":7}},{"name":"PolicyNetwork","generated":{"line":269,"column":36},"source":"index.js","original":{"line":254,"column":43}},{"generated":{"line":269,"column":49},"source":"index.js","original":{"line":254,"column":7}},{"generated":{"line":269,"column":50},"source":"index.js","original":{"line":254,"column":57}},{"generated":{"line":270,"column":0},"source":"index.js","original":{"line":255,"column":2}},{"name":"constructor","generated":{"line":275,"column":0},"source":"index.js","original":{"line":260,"column":2}},{"name":"constructor","generated":{"line":275,"column":2},"source":"index.js","original":{"line":260,"column":2}},{"generated":{"line":275,"column":13},"source":"index.js","original":{"line":260,"column":13}},{"name":"hiddenLayerSizesOrModel","generated":{"line":275,"column":14},"source":"index.js","original":{"line":260,"column":14}},{"generated":{"line":275,"column":37},"source":"index.js","original":{"line":260,"column":13}},{"generated":{"line":275,"column":39},"source":"index.js","original":{"line":260,"column":39}},{"generated":{"line":276,"column":0},"source":"index.js","original":{"line":261,"column":4}},{"name":"hiddenLayerSizesOrModel","generated":{"line":276,"column":10},"source":"index.js","original":{"line":261,"column":10}},{"generated":{"line":276,"column":33},"source":"index.js","original":{"line":261,"column":4}},{"generated":{"line":277,"column":0},"source":"index.js","original":{"line":262,"column":3}},{"generated":{"line":278,"column":0},"source":"index.js","original":{"line":264,"column":2}},{"generated":{"line":283,"column":0},"source":"index.js","original":{"line":267,"column":2}},{"name":"saveModel","generated":{"line":283,"column":8},"source":"index.js","original":{"line":267,"column":8}},{"generated":{"line":283,"column":17},"source":"index.js","original":{"line":267,"column":2}},{"generated":{"line":283,"column":20},"source":"index.js","original":{"line":267,"column":20}},{"generated":{"line":284,"column":0},"source":"index.js","original":{"line":268,"column":4}},{"generated":{"line":284,"column":11},"source":"index.js","original":{"line":268,"column":11}},{"generated":{"line":284,"column":17},"source":"index.js","original":{"line":268,"column":17}},{"name":"model","generated":{"line":284,"column":22},"source":"index.js","original":{"line":268,"column":22}},{"generated":{"line":284,"column":27},"source":"index.js","original":{"line":268,"column":17}},{"name":"save","generated":{"line":284,"column":28},"source":"index.js","original":{"line":268,"column":28}},{"generated":{"line":284,"column":32},"source":"index.js","original":{"line":268,"column":17}},{"name":"MODEL_SAVE_PATH_","generated":{"line":284,"column":33},"source":"index.js","original":{"line":268,"column":33}},{"generated":{"line":284,"column":49},"source":"index.js","original":{"line":268,"column":17}},{"generated":{"line":284,"column":50},"source":"index.js","original":{"line":268,"column":4}},{"generated":{"line":285,"column":0},"source":"index.js","original":{"line":269,"column":3}},{"generated":{"line":286,"column":0},"source":"index.js","original":{"line":271,"column":2}},{"generated":{"line":295,"column":0},"source":"index.js","original":{"line":278,"column":2}},{"name":"loadModel","generated":{"line":295,"column":15},"source":"index.js","original":{"line":278,"column":15}},{"generated":{"line":295,"column":24},"source":"index.js","original":{"line":278,"column":2}},{"generated":{"line":295,"column":27},"source":"index.js","original":{"line":278,"column":27}},{"generated":{"line":296,"column":0},"source":"index.js","original":{"line":279,"column":4}},{"name":"modelsInfo","generated":{"line":296,"column":10},"source":"index.js","original":{"line":279,"column":10}},{"generated":{"line":296,"column":20},"source":"index.js","original":{"line":279,"column":20}},{"generated":{"line":296,"column":23},"source":"index.js","original":{"line":279,"column":23}},{"name":"tf","generated":{"line":296,"column":29},"source":"index.js","original":{"line":279,"column":29}},{"generated":{"line":296,"column":31},"source":"index.js","original":{"line":279,"column":31}},{"name":"io","generated":{"line":296,"column":32},"source":"index.js","original":{"line":279,"column":32}},{"generated":{"line":296,"column":34},"source":"index.js","original":{"line":279,"column":29}},{"name":"listModels","generated":{"line":296,"column":35},"source":"index.js","original":{"line":279,"column":35}},{"generated":{"line":296,"column":45},"source":"index.js","original":{"line":279,"column":29}},{"generated":{"line":296,"column":47},"source":"index.js","original":{"line":279,"column":4}},{"generated":{"line":298,"column":0},"source":"index.js","original":{"line":280,"column":4}},{"name":"MODEL_SAVE_PATH_","generated":{"line":298,"column":8},"source":"index.js","original":{"line":280,"column":8}},{"generated":{"line":298,"column":24},"source":"index.js","original":{"line":280,"column":24}},{"name":"modelsInfo","generated":{"line":298,"column":28},"source":"index.js","original":{"line":280,"column":28}},{"generated":{"line":298,"column":38},"source":"index.js","original":{"line":280,"column":4}},{"generated":{"line":298,"column":40},"source":"index.js","original":{"line":280,"column":40}},{"name":"console","generated":{"line":299,"column":0},"source":"index.js","original":{"line":281,"column":6}},{"name":"console","generated":{"line":299,"column":6},"source":"index.js","original":{"line":281,"column":6}},{"generated":{"line":299,"column":13},"source":"index.js","original":{"line":281,"column":13}},{"name":"log","generated":{"line":299,"column":14},"source":"index.js","original":{"line":281,"column":14}},{"generated":{"line":299,"column":17},"source":"index.js","original":{"line":281,"column":6}},{"generated":{"line":299,"column":18},"source":"index.js","original":{"line":281,"column":19}},{"generated":{"line":299,"column":45},"source":"index.js","original":{"line":281,"column":6}},{"generated":{"line":300,"column":0},"source":"index.js","original":{"line":282,"column":6}},{"name":"model","generated":{"line":300,"column":12},"source":"index.js","original":{"line":282,"column":12}},{"generated":{"line":300,"column":17},"source":"index.js","original":{"line":282,"column":17}},{"generated":{"line":300,"column":20},"source":"index.js","original":{"line":282,"column":20}},{"name":"tf","generated":{"line":300,"column":26},"source":"index.js","original":{"line":282,"column":26}},{"generated":{"line":300,"column":28},"source":"index.js","original":{"line":282,"column":28}},{"name":"loadModel","generated":{"line":300,"column":29},"source":"index.js","original":{"line":282,"column":29}},{"generated":{"line":300,"column":38},"source":"index.js","original":{"line":282,"column":26}},{"name":"MODEL_SAVE_PATH_","generated":{"line":300,"column":39},"source":"index.js","original":{"line":282,"column":39}},{"generated":{"line":300,"column":55},"source":"index.js","original":{"line":282,"column":26}},{"generated":{"line":300,"column":56},"source":"index.js","original":{"line":282,"column":6}},{"name":"console","generated":{"line":301,"column":0},"source":"index.js","original":{"line":283,"column":6}},{"name":"console","generated":{"line":301,"column":6},"source":"index.js","original":{"line":283,"column":6}},{"generated":{"line":301,"column":13},"source":"index.js","original":{"line":283,"column":13}},{"name":"log","generated":{"line":301,"column":14},"source":"index.js","original":{"line":283,"column":14}},{"generated":{"line":301,"column":17},"source":"index.js","original":{"line":283,"column":6}},{"generated":{"line":301,"column":18},"source":"index.js","original":{"line":283,"column":19}},{"name":"MODEL_SAVE_PATH_","generated":{"line":301,"column":39},"source":"index.js","original":{"line":283,"column":39}},{"generated":{"line":301,"column":55},"source":"index.js","original":{"line":283,"column":56}},{"generated":{"line":301,"column":57},"source":"index.js","original":{"line":283,"column":6}},{"generated":{"line":302,"column":0},"source":"index.js","original":{"line":284,"column":6}},{"generated":{"line":302,"column":13},"source":"index.js","original":{"line":284,"column":13}},{"name":"SaveablePolicyNetwork","generated":{"line":302,"column":17},"source":"index.js","original":{"line":284,"column":17}},{"generated":{"line":302,"column":38},"source":"index.js","original":{"line":284,"column":13}},{"name":"model","generated":{"line":302,"column":39},"source":"index.js","original":{"line":284,"column":39}},{"generated":{"line":302,"column":44},"source":"index.js","original":{"line":284,"column":13}},{"generated":{"line":302,"column":45},"source":"index.js","original":{"line":284,"column":6}},{"generated":{"line":303,"column":0},"source":"index.js","original":{"line":285,"column":5}},{"generated":{"line":303,"column":5},"source":"index.js","original":{"line":280,"column":4}},{"generated":{"line":303,"column":11},"source":"index.js","original":{"line":285,"column":11}},{"generated":{"line":304,"column":0},"source":"index.js","original":{"line":286,"column":6}},{"generated":{"line":304,"column":12},"source":"index.js","original":{"line":286,"column":12}},{"name":"Error","generated":{"line":304,"column":16},"source":"index.js","original":{"line":286,"column":16}},{"generated":{"line":304,"column":21},"source":"index.js","original":{"line":286,"column":12}},{"generated":{"line":304,"column":22},"source":"index.js","original":{"line":286,"column":23}},{"name":"MODEL_SAVE_PATH_","generated":{"line":304,"column":46},"source":"index.js","original":{"line":286,"column":46}},{"generated":{"line":304,"column":62},"source":"index.js","original":{"line":286,"column":63}},{"generated":{"line":304,"column":65},"source":"index.js","original":{"line":286,"column":12}},{"generated":{"line":304,"column":66},"source":"index.js","original":{"line":286,"column":6}},{"generated":{"line":305,"column":0},"source":"index.js","original":{"line":287,"column":5}},{"generated":{"line":306,"column":0},"source":"index.js","original":{"line":288,"column":3}},{"generated":{"line":307,"column":0},"source":"index.js","original":{"line":290,"column":2}},{"generated":{"line":315,"column":0},"source":"index.js","original":{"line":296,"column":2}},{"name":"checkStoredModelStatus","generated":{"line":315,"column":15},"source":"index.js","original":{"line":296,"column":15}},{"generated":{"line":315,"column":37},"source":"index.js","original":{"line":296,"column":2}},{"generated":{"line":315,"column":40},"source":"index.js","original":{"line":296,"column":40}},{"generated":{"line":316,"column":0},"source":"index.js","original":{"line":297,"column":4}},{"name":"modelsInfo","generated":{"line":316,"column":10},"source":"index.js","original":{"line":297,"column":10}},{"generated":{"line":316,"column":20},"source":"index.js","original":{"line":297,"column":20}},{"generated":{"line":316,"column":23},"source":"index.js","original":{"line":297,"column":23}},{"name":"tf","generated":{"line":316,"column":29},"source":"index.js","original":{"line":297,"column":29}},{"generated":{"line":316,"column":31},"source":"index.js","original":{"line":297,"column":31}},{"name":"io","generated":{"line":316,"column":32},"source":"index.js","original":{"line":297,"column":32}},{"generated":{"line":316,"column":34},"source":"index.js","original":{"line":297,"column":29}},{"name":"listModels","generated":{"line":316,"column":35},"source":"index.js","original":{"line":297,"column":35}},{"generated":{"line":316,"column":45},"source":"index.js","original":{"line":297,"column":29}},{"generated":{"line":316,"column":47},"source":"index.js","original":{"line":297,"column":4}},{"generated":{"line":317,"column":0},"source":"index.js","original":{"line":298,"column":4}},{"name":"modelsInfo","generated":{"line":317,"column":11},"source":"index.js","original":{"line":298,"column":11}},{"generated":{"line":317,"column":21},"source":"index.js","original":{"line":298,"column":21}},{"name":"MODEL_SAVE_PATH_","generated":{"line":317,"column":22},"source":"index.js","original":{"line":298,"column":22}},{"generated":{"line":317,"column":38},"source":"index.js","original":{"line":298,"column":21}},{"generated":{"line":317,"column":39},"source":"index.js","original":{"line":298,"column":4}},{"generated":{"line":318,"column":0},"source":"index.js","original":{"line":299,"column":3}},{"generated":{"line":319,"column":0},"source":"index.js","original":{"line":301,"column":2}},{"generated":{"line":324,"column":0},"source":"index.js","original":{"line":304,"column":2}},{"name":"removeModel","generated":{"line":324,"column":8},"source":"index.js","original":{"line":304,"column":8}},{"generated":{"line":324,"column":19},"source":"index.js","original":{"line":304,"column":2}},{"generated":{"line":324,"column":22},"source":"index.js","original":{"line":304,"column":22}},{"generated":{"line":325,"column":0},"source":"index.js","original":{"line":305,"column":4}},{"generated":{"line":325,"column":11},"source":"index.js","original":{"line":305,"column":11}},{"name":"tf","generated":{"line":325,"column":17},"source":"index.js","original":{"line":305,"column":17}},{"generated":{"line":325,"column":19},"source":"index.js","original":{"line":305,"column":19}},{"name":"io","generated":{"line":325,"column":20},"source":"index.js","original":{"line":305,"column":20}},{"generated":{"line":325,"column":22},"source":"index.js","original":{"line":305,"column":17}},{"name":"removeModel","generated":{"line":325,"column":23},"source":"index.js","original":{"line":305,"column":23}},{"generated":{"line":325,"column":34},"source":"index.js","original":{"line":305,"column":17}},{"name":"MODEL_SAVE_PATH_","generated":{"line":325,"column":35},"source":"index.js","original":{"line":305,"column":35}},{"generated":{"line":325,"column":51},"source":"index.js","original":{"line":305,"column":17}},{"generated":{"line":325,"column":52},"source":"index.js","original":{"line":305,"column":4}},{"generated":{"line":326,"column":0},"source":"index.js","original":{"line":306,"column":3}},{"generated":{"line":327,"column":0},"source":"index.js","original":{"line":308,"column":2}},{"name":"hiddenLayerSizes","generated":{"line":336,"column":0},"source":"index.js","original":{"line":315,"column":2}},{"name":"hiddenLayerSizes","generated":{"line":336,"column":2},"source":"index.js","original":{"line":315,"column":2}},{"generated":{"line":336,"column":18},"source":"index.js","original":{"line":315,"column":18}},{"generated":{"line":336,"column":21},"source":"index.js","original":{"line":315,"column":21}},{"generated":{"line":337,"column":0},"source":"index.js","original":{"line":316,"column":4}},{"name":"sizes","generated":{"line":337,"column":10},"source":"index.js","original":{"line":316,"column":10}},{"generated":{"line":337,"column":15},"source":"index.js","original":{"line":316,"column":15}},{"generated":{"line":337,"column":18},"source":"index.js","original":{"line":316,"column":18}},{"generated":{"line":337,"column":20},"source":"index.js","original":{"line":316,"column":4}},{"generated":{"line":339,"column":0},"source":"index.js","original":{"line":317,"column":4}},{"generated":{"line":339,"column":9},"source":"index.js","original":{"line":317,"column":9}},{"name":"i","generated":{"line":339,"column":13},"source":"index.js","original":{"line":317,"column":13}},{"generated":{"line":339,"column":14},"source":"index.js","original":{"line":317,"column":14}},{"generated":{"line":339,"column":17},"source":"index.js","original":{"line":317,"column":17}},{"generated":{"line":339,"column":18},"source":"index.js","original":{"line":317,"column":4}},{"name":"i","generated":{"line":339,"column":20},"source":"index.js","original":{"line":317,"column":20}},{"generated":{"line":339,"column":21},"source":"index.js","original":{"line":317,"column":21}},{"generated":{"line":339,"column":24},"source":"index.js","original":{"line":317,"column":24}},{"name":"model","generated":{"line":339,"column":29},"source":"index.js","original":{"line":317,"column":29}},{"generated":{"line":339,"column":34},"source":"index.js","original":{"line":317,"column":24}},{"name":"layers","generated":{"line":339,"column":35},"source":"index.js","original":{"line":317,"column":35}},{"generated":{"line":339,"column":41},"source":"index.js","original":{"line":317,"column":24}},{"name":"length","generated":{"line":339,"column":42},"source":"index.js","original":{"line":317,"column":42}},{"generated":{"line":339,"column":48},"source":"index.js","original":{"line":317,"column":24}},{"generated":{"line":339,"column":51},"source":"index.js","original":{"line":317,"column":51}},{"generated":{"line":339,"column":52},"source":"index.js","original":{"line":317,"column":4}},{"generated":{"line":339,"column":54},"source":"index.js","original":{"line":317,"column":54}},{"name":"i","generated":{"line":339,"column":56},"source":"index.js","original":{"line":317,"column":56}},{"generated":{"line":339,"column":57},"source":"index.js","original":{"line":317,"column":4}},{"generated":{"line":339,"column":59},"source":"index.js","original":{"line":317,"column":59}},{"name":"sizes","generated":{"line":340,"column":0},"source":"index.js","original":{"line":318,"column":6}},{"name":"sizes","generated":{"line":340,"column":6},"source":"index.js","original":{"line":318,"column":6}},{"generated":{"line":340,"column":11},"source":"index.js","original":{"line":318,"column":11}},{"name":"push","generated":{"line":340,"column":12},"source":"index.js","original":{"line":318,"column":12}},{"generated":{"line":340,"column":16},"source":"index.js","original":{"line":318,"column":6}},{"generated":{"line":340,"column":17},"source":"index.js","original":{"line":318,"column":17}},{"name":"model","generated":{"line":340,"column":22},"source":"index.js","original":{"line":318,"column":22}},{"generated":{"line":340,"column":27},"source":"index.js","original":{"line":318,"column":17}},{"name":"layers","generated":{"line":340,"column":28},"source":"index.js","original":{"line":318,"column":28}},{"generated":{"line":340,"column":34},"source":"index.js","original":{"line":318,"column":17}},{"name":"i","generated":{"line":340,"column":35},"source":"index.js","original":{"line":318,"column":35}},{"generated":{"line":340,"column":36},"source":"index.js","original":{"line":318,"column":17}},{"name":"units","generated":{"line":340,"column":38},"source":"index.js","original":{"line":318,"column":38}},{"generated":{"line":340,"column":43},"source":"index.js","original":{"line":318,"column":6}},{"generated":{"line":341,"column":0},"source":"index.js","original":{"line":319,"column":5}},{"generated":{"line":343,"column":0},"source":"index.js","original":{"line":320,"column":4}},{"name":"sizes","generated":{"line":343,"column":11},"source":"index.js","original":{"line":320,"column":11}},{"generated":{"line":343,"column":16},"source":"index.js","original":{"line":320,"column":16}},{"name":"length","generated":{"line":343,"column":17},"source":"index.js","original":{"line":320,"column":17}},{"generated":{"line":343,"column":23},"source":"index.js","original":{"line":320,"column":11}},{"generated":{"line":343,"column":28},"source":"index.js","original":{"line":320,"column":28}},{"generated":{"line":343,"column":29},"source":"index.js","original":{"line":320,"column":11}},{"name":"sizes","generated":{"line":343,"column":32},"source":"index.js","original":{"line":320,"column":32}},{"generated":{"line":343,"column":37},"source":"index.js","original":{"line":320,"column":37}},{"generated":{"line":343,"column":38},"source":"index.js","original":{"line":320,"column":38}},{"generated":{"line":343,"column":39},"source":"index.js","original":{"line":320,"column":37}},{"generated":{"line":343,"column":40},"source":"index.js","original":{"line":320,"column":11}},{"name":"sizes","generated":{"line":343,"column":43},"source":"index.js","original":{"line":320,"column":43}},{"generated":{"line":343,"column":48},"source":"index.js","original":{"line":320,"column":4}},{"generated":{"line":344,"column":0},"source":"index.js","original":{"line":321,"column":3}},{"generated":{"line":346,"column":0},"source":"index.js","original":{"line":254,"column":57}},{"generated":{"line":347,"column":0},"source":"index.js","original":{"line":324,"column":0}},{"generated":{"line":359,"column":0},"source":"index.js","original":{"line":332,"column":0}},{"name":"discountRewards","generated":{"line":359,"column":9},"source":"index.js","original":{"line":332,"column":9}},{"generated":{"line":359,"column":24},"source":"index.js","original":{"line":332,"column":0}},{"name":"rewards","generated":{"line":359,"column":25},"source":"index.js","original":{"line":332,"column":25}},{"generated":{"line":359,"column":32},"source":"index.js","original":{"line":332,"column":0}},{"name":"discountRate","generated":{"line":359,"column":34},"source":"index.js","original":{"line":332,"column":34}},{"generated":{"line":359,"column":46},"source":"index.js","original":{"line":332,"column":0}},{"generated":{"line":359,"column":48},"source":"index.js","original":{"line":332,"column":48}},{"generated":{"line":360,"column":0},"source":"index.js","original":{"line":333,"column":2}},{"name":"discountedBuffer","generated":{"line":360,"column":8},"source":"index.js","original":{"line":333,"column":8}},{"generated":{"line":360,"column":24},"source":"index.js","original":{"line":333,"column":24}},{"name":"tf","generated":{"line":360,"column":27},"source":"index.js","original":{"line":333,"column":27}},{"generated":{"line":360,"column":29},"source":"index.js","original":{"line":333,"column":29}},{"name":"buffer","generated":{"line":360,"column":30},"source":"index.js","original":{"line":333,"column":30}},{"generated":{"line":360,"column":36},"source":"index.js","original":{"line":333,"column":27}},{"generated":{"line":360,"column":37},"source":"index.js","original":{"line":333,"column":37}},{"name":"rewards","generated":{"line":360,"column":38},"source":"index.js","original":{"line":333,"column":38}},{"generated":{"line":360,"column":45},"source":"index.js","original":{"line":333,"column":45}},{"name":"length","generated":{"line":360,"column":46},"source":"index.js","original":{"line":333,"column":46}},{"generated":{"line":360,"column":52},"source":"index.js","original":{"line":333,"column":37}},{"generated":{"line":360,"column":53},"source":"index.js","original":{"line":333,"column":27}},{"generated":{"line":360,"column":54},"source":"index.js","original":{"line":333,"column":2}},{"generated":{"line":361,"column":0},"source":"index.js","original":{"line":334,"column":2}},{"name":"prev","generated":{"line":361,"column":6},"source":"index.js","original":{"line":334,"column":6}},{"generated":{"line":361,"column":10},"source":"index.js","original":{"line":334,"column":10}},{"generated":{"line":361,"column":13},"source":"index.js","original":{"line":334,"column":13}},{"generated":{"line":361,"column":14},"source":"index.js","original":{"line":334,"column":2}},{"generated":{"line":363,"column":0},"source":"index.js","original":{"line":335,"column":2}},{"generated":{"line":363,"column":7},"source":"index.js","original":{"line":335,"column":7}},{"name":"i","generated":{"line":363,"column":11},"source":"index.js","original":{"line":335,"column":11}},{"generated":{"line":363,"column":12},"source":"index.js","original":{"line":335,"column":12}},{"name":"rewards","generated":{"line":363,"column":15},"source":"index.js","original":{"line":335,"column":15}},{"generated":{"line":363,"column":22},"source":"index.js","original":{"line":335,"column":22}},{"name":"length","generated":{"line":363,"column":23},"source":"index.js","original":{"line":335,"column":23}},{"generated":{"line":363,"column":29},"source":"index.js","original":{"line":335,"column":15}},{"generated":{"line":363,"column":32},"source":"index.js","original":{"line":335,"column":32}},{"generated":{"line":363,"column":33},"source":"index.js","original":{"line":335,"column":2}},{"name":"i","generated":{"line":363,"column":35},"source":"index.js","original":{"line":335,"column":35}},{"generated":{"line":363,"column":36},"source":"index.js","original":{"line":335,"column":36}},{"generated":{"line":363,"column":40},"source":"index.js","original":{"line":335,"column":40}},{"generated":{"line":363,"column":41},"source":"index.js","original":{"line":335,"column":2}},{"generated":{"line":363,"column":43},"source":"index.js","original":{"line":335,"column":43}},{"name":"i","generated":{"line":363,"column":45},"source":"index.js","original":{"line":335,"column":45}},{"generated":{"line":363,"column":46},"source":"index.js","original":{"line":335,"column":2}},{"generated":{"line":363,"column":48},"source":"index.js","original":{"line":335,"column":48}},{"generated":{"line":364,"column":0},"source":"index.js","original":{"line":336,"column":4}},{"name":"current","generated":{"line":364,"column":10},"source":"index.js","original":{"line":336,"column":10}},{"generated":{"line":364,"column":17},"source":"index.js","original":{"line":336,"column":17}},{"name":"discountRate","generated":{"line":364,"column":20},"source":"index.js","original":{"line":336,"column":20}},{"generated":{"line":364,"column":32},"source":"index.js","original":{"line":336,"column":32}},{"name":"prev","generated":{"line":364,"column":35},"source":"index.js","original":{"line":336,"column":35}},{"generated":{"line":364,"column":39},"source":"index.js","original":{"line":336,"column":20}},{"name":"rewards","generated":{"line":364,"column":42},"source":"index.js","original":{"line":336,"column":42}},{"generated":{"line":364,"column":49},"source":"index.js","original":{"line":336,"column":49}},{"name":"i","generated":{"line":364,"column":50},"source":"index.js","original":{"line":336,"column":50}},{"generated":{"line":364,"column":51},"source":"index.js","original":{"line":336,"column":49}},{"generated":{"line":364,"column":52},"source":"index.js","original":{"line":336,"column":4}},{"name":"discountedBuffer","generated":{"line":365,"column":0},"source":"index.js","original":{"line":337,"column":4}},{"name":"discountedBuffer","generated":{"line":365,"column":4},"source":"index.js","original":{"line":337,"column":4}},{"generated":{"line":365,"column":20},"source":"index.js","original":{"line":337,"column":20}},{"name":"set","generated":{"line":365,"column":21},"source":"index.js","original":{"line":337,"column":21}},{"generated":{"line":365,"column":24},"source":"index.js","original":{"line":337,"column":4}},{"name":"current","generated":{"line":365,"column":25},"source":"index.js","original":{"line":337,"column":25}},{"generated":{"line":365,"column":32},"source":"index.js","original":{"line":337,"column":4}},{"name":"i","generated":{"line":365,"column":34},"source":"index.js","original":{"line":337,"column":34}},{"generated":{"line":365,"column":35},"source":"index.js","original":{"line":337,"column":4}},{"name":"prev","generated":{"line":366,"column":0},"source":"index.js","original":{"line":338,"column":4}},{"name":"prev","generated":{"line":366,"column":4},"source":"index.js","original":{"line":338,"column":4}},{"generated":{"line":366,"column":8},"source":"index.js","original":{"line":338,"column":8}},{"name":"current","generated":{"line":366,"column":11},"source":"index.js","original":{"line":338,"column":11}},{"generated":{"line":366,"column":18},"source":"index.js","original":{"line":338,"column":4}},{"generated":{"line":367,"column":0},"source":"index.js","original":{"line":339,"column":3}},{"generated":{"line":369,"column":0},"source":"index.js","original":{"line":340,"column":2}},{"name":"discountedBuffer","generated":{"line":369,"column":9},"source":"index.js","original":{"line":340,"column":9}},{"generated":{"line":369,"column":25},"source":"index.js","original":{"line":340,"column":25}},{"name":"toTensor","generated":{"line":369,"column":26},"source":"index.js","original":{"line":340,"column":26}},{"generated":{"line":369,"column":34},"source":"index.js","original":{"line":340,"column":9}},{"generated":{"line":369,"column":36},"source":"index.js","original":{"line":340,"column":2}},{"generated":{"line":370,"column":0},"source":"index.js","original":{"line":341,"column":1}},{"generated":{"line":371,"column":0},"source":"index.js","original":{"line":343,"column":0}},{"generated":{"line":388,"column":0},"source":"index.js","original":{"line":358,"column":0}},{"name":"discountAndNormalizeRewards","generated":{"line":388,"column":9},"source":"index.js","original":{"line":358,"column":9}},{"generated":{"line":388,"column":36},"source":"index.js","original":{"line":358,"column":0}},{"name":"rewardSequences","generated":{"line":388,"column":37},"source":"index.js","original":{"line":358,"column":37}},{"generated":{"line":388,"column":52},"source":"index.js","original":{"line":358,"column":0}},{"name":"discountRate","generated":{"line":388,"column":54},"source":"index.js","original":{"line":358,"column":54}},{"generated":{"line":388,"column":66},"source":"index.js","original":{"line":358,"column":0}},{"generated":{"line":388,"column":68},"source":"index.js","original":{"line":358,"column":68}},{"generated":{"line":389,"column":0},"source":"index.js","original":{"line":359,"column":2}},{"name":"tf","generated":{"line":389,"column":9},"source":"index.js","original":{"line":359,"column":9}},{"generated":{"line":389,"column":11},"source":"index.js","original":{"line":359,"column":11}},{"name":"tidy","generated":{"line":389,"column":12},"source":"index.js","original":{"line":359,"column":12}},{"generated":{"line":389,"column":16},"source":"index.js","original":{"line":359,"column":9}},{"generated":{"line":389,"column":17},"source":"index.js","original":{"line":359,"column":17}},{"generated":{"line":389,"column":23},"source":"index.js","original":{"line":359,"column":23}},{"generated":{"line":390,"column":0},"source":"index.js","original":{"line":360,"column":4}},{"name":"discounted","generated":{"line":390,"column":10},"source":"index.js","original":{"line":360,"column":10}},{"generated":{"line":390,"column":20},"source":"index.js","original":{"line":360,"column":20}},{"generated":{"line":390,"column":23},"source":"index.js","original":{"line":360,"column":23}},{"generated":{"line":390,"column":25},"source":"index.js","original":{"line":360,"column":4}},{"generated":{"line":392,"column":0},"source":"index.js","original":{"line":361,"column":4}},{"generated":{"line":392,"column":9},"source":"index.js","original":{"line":361,"column":9}},{"name":"sequence","generated":{"line":392,"column":15},"source":"index.js","original":{"line":361,"column":15}},{"generated":{"line":392,"column":23},"source":"index.js","original":{"line":361,"column":4}},{"name":"rewardSequences","generated":{"line":392,"column":27},"source":"index.js","original":{"line":361,"column":27}},{"generated":{"line":392,"column":42},"source":"index.js","original":{"line":361,"column":4}},{"generated":{"line":392,"column":44},"source":"index.js","original":{"line":361,"column":44}},{"name":"discounted","generated":{"line":393,"column":0},"source":"index.js","original":{"line":362,"column":6}},{"name":"discounted","generated":{"line":393,"column":6},"source":"index.js","original":{"line":362,"column":6}},{"generated":{"line":393,"column":16},"source":"index.js","original":{"line":362,"column":16}},{"name":"push","generated":{"line":393,"column":17},"source":"index.js","original":{"line":362,"column":17}},{"generated":{"line":393,"column":21},"source":"index.js","original":{"line":362,"column":6}},{"name":"discountRewards","generated":{"line":393,"column":22},"source":"index.js","original":{"line":362,"column":22}},{"generated":{"line":393,"column":37},"source":"index.js","original":{"line":362,"column":37}},{"name":"sequence","generated":{"line":393,"column":38},"source":"index.js","original":{"line":362,"column":38}},{"generated":{"line":393,"column":46},"source":"index.js","original":{"line":362,"column":37}},{"name":"discountRate","generated":{"line":393,"column":48},"source":"index.js","original":{"line":362,"column":48}},{"generated":{"line":393,"column":60},"source":"index.js","original":{"line":362,"column":37}},{"generated":{"line":393,"column":61},"source":"index.js","original":{"line":362,"column":6}},{"generated":{"line":394,"column":0},"source":"index.js","original":{"line":363,"column":5}},{"generated":{"line":394,"column":5},"source":"index.js","original":{"line":359,"column":23}},{"generated":{"line":394,"column":6},"source":"index.js","original":{"line":364,"column":4}},{"generated":{"line":397,"column":0},"source":"index.js","original":{"line":365,"column":4}},{"name":"concatenated","generated":{"line":397,"column":10},"source":"index.js","original":{"line":365,"column":10}},{"generated":{"line":397,"column":22},"source":"index.js","original":{"line":365,"column":22}},{"name":"tf","generated":{"line":397,"column":25},"source":"index.js","original":{"line":365,"column":25}},{"generated":{"line":397,"column":27},"source":"index.js","original":{"line":365,"column":27}},{"name":"concat","generated":{"line":397,"column":28},"source":"index.js","original":{"line":365,"column":28}},{"generated":{"line":397,"column":34},"source":"index.js","original":{"line":365,"column":25}},{"name":"discounted","generated":{"line":397,"column":35},"source":"index.js","original":{"line":365,"column":35}},{"generated":{"line":397,"column":45},"source":"index.js","original":{"line":365,"column":25}},{"generated":{"line":397,"column":46},"source":"index.js","original":{"line":365,"column":4}},{"generated":{"line":398,"column":0},"source":"index.js","original":{"line":366,"column":4}},{"name":"mean","generated":{"line":398,"column":10},"source":"index.js","original":{"line":366,"column":10}},{"generated":{"line":398,"column":14},"source":"index.js","original":{"line":366,"column":14}},{"name":"tf","generated":{"line":398,"column":17},"source":"index.js","original":{"line":366,"column":17}},{"generated":{"line":398,"column":19},"source":"index.js","original":{"line":366,"column":19}},{"name":"mean","generated":{"line":398,"column":20},"source":"index.js","original":{"line":366,"column":20}},{"generated":{"line":398,"column":24},"source":"index.js","original":{"line":366,"column":17}},{"name":"concatenated","generated":{"line":398,"column":25},"source":"index.js","original":{"line":366,"column":25}},{"generated":{"line":398,"column":37},"source":"index.js","original":{"line":366,"column":17}},{"generated":{"line":398,"column":38},"source":"index.js","original":{"line":366,"column":4}},{"generated":{"line":399,"column":0},"source":"index.js","original":{"line":367,"column":4}},{"name":"std","generated":{"line":399,"column":10},"source":"index.js","original":{"line":367,"column":10}},{"generated":{"line":399,"column":13},"source":"index.js","original":{"line":367,"column":13}},{"name":"tf","generated":{"line":399,"column":16},"source":"index.js","original":{"line":367,"column":16}},{"generated":{"line":399,"column":18},"source":"index.js","original":{"line":367,"column":18}},{"name":"sqrt","generated":{"line":399,"column":19},"source":"index.js","original":{"line":367,"column":19}},{"generated":{"line":399,"column":23},"source":"index.js","original":{"line":367,"column":16}},{"name":"tf","generated":{"line":399,"column":24},"source":"index.js","original":{"line":367,"column":24}},{"generated":{"line":399,"column":26},"source":"index.js","original":{"line":367,"column":26}},{"name":"mean","generated":{"line":399,"column":27},"source":"index.js","original":{"line":367,"column":27}},{"generated":{"line":399,"column":31},"source":"index.js","original":{"line":367,"column":24}},{"name":"tf","generated":{"line":399,"column":32},"source":"index.js","original":{"line":367,"column":32}},{"generated":{"line":399,"column":34},"source":"index.js","original":{"line":367,"column":34}},{"name":"square","generated":{"line":399,"column":35},"source":"index.js","original":{"line":367,"column":35}},{"generated":{"line":399,"column":41},"source":"index.js","original":{"line":367,"column":32}},{"name":"concatenated","generated":{"line":399,"column":42},"source":"index.js","original":{"line":367,"column":42}},{"generated":{"line":399,"column":54},"source":"index.js","original":{"line":367,"column":54}},{"name":"sub","generated":{"line":399,"column":55},"source":"index.js","original":{"line":367,"column":55}},{"generated":{"line":399,"column":58},"source":"index.js","original":{"line":367,"column":42}},{"name":"mean","generated":{"line":399,"column":59},"source":"index.js","original":{"line":367,"column":59}},{"generated":{"line":399,"column":63},"source":"index.js","original":{"line":367,"column":42}},{"generated":{"line":399,"column":64},"source":"index.js","original":{"line":367,"column":32}},{"generated":{"line":399,"column":65},"source":"index.js","original":{"line":367,"column":24}},{"generated":{"line":399,"column":66},"source":"index.js","original":{"line":367,"column":16}},{"generated":{"line":399,"column":67},"source":"index.js","original":{"line":367,"column":4}},{"generated":{"line":399,"column":68},"source":"index.js","original":{"line":359,"column":23}},{"generated":{"line":399,"column":69},"source":"index.js","original":{"line":368,"column":4}},{"generated":{"line":401,"column":0},"source":"index.js","original":{"line":369,"column":4}},{"name":"normalized","generated":{"line":401,"column":10},"source":"index.js","original":{"line":369,"column":10}},{"generated":{"line":401,"column":20},"source":"index.js","original":{"line":369,"column":20}},{"name":"discounted","generated":{"line":401,"column":23},"source":"index.js","original":{"line":369,"column":23}},{"generated":{"line":401,"column":33},"source":"index.js","original":{"line":369,"column":33}},{"name":"map","generated":{"line":401,"column":34},"source":"index.js","original":{"line":369,"column":34}},{"generated":{"line":401,"column":37},"source":"index.js","original":{"line":369,"column":23}},{"name":"rs","generated":{"line":401,"column":38},"source":"index.js","original":{"line":369,"column":38}},{"generated":{"line":401,"column":40},"source":"index.js","original":{"line":369,"column":40}},{"name":"rs","generated":{"line":401,"column":44},"source":"index.js","original":{"line":369,"column":44}},{"generated":{"line":401,"column":46},"source":"index.js","original":{"line":369,"column":46}},{"name":"sub","generated":{"line":401,"column":47},"source":"index.js","original":{"line":369,"column":47}},{"generated":{"line":401,"column":50},"source":"index.js","original":{"line":369,"column":44}},{"name":"mean","generated":{"line":401,"column":51},"source":"index.js","original":{"line":369,"column":51}},{"generated":{"line":401,"column":55},"source":"index.js","original":{"line":369,"column":44}},{"name":"div","generated":{"line":401,"column":57},"source":"index.js","original":{"line":369,"column":57}},{"generated":{"line":401,"column":60},"source":"index.js","original":{"line":369,"column":44}},{"name":"std","generated":{"line":401,"column":61},"source":"index.js","original":{"line":369,"column":61}},{"generated":{"line":401,"column":64},"source":"index.js","original":{"line":369,"column":44}},{"generated":{"line":401,"column":65},"source":"index.js","original":{"line":369,"column":23}},{"generated":{"line":401,"column":66},"source":"index.js","original":{"line":369,"column":4}},{"generated":{"line":402,"column":0},"source":"index.js","original":{"line":370,"column":4}},{"name":"normalized","generated":{"line":402,"column":11},"source":"index.js","original":{"line":370,"column":11}},{"generated":{"line":402,"column":21},"source":"index.js","original":{"line":370,"column":4}},{"generated":{"line":403,"column":0},"source":"index.js","original":{"line":371,"column":3}},{"generated":{"line":403,"column":3},"source":"index.js","original":{"line":359,"column":9}},{"generated":{"line":403,"column":4},"source":"index.js","original":{"line":359,"column":2}},{"generated":{"line":404,"column":0},"source":"index.js","original":{"line":372,"column":1}},{"generated":{"line":405,"column":0},"source":"index.js","original":{"line":374,"column":0}},{"generated":{"line":422,"column":0},"source":"index.js","original":{"line":389,"column":0}},{"name":"scaleAndAverageGradients","generated":{"line":422,"column":9},"source":"index.js","original":{"line":389,"column":9}},{"generated":{"line":422,"column":33},"source":"index.js","original":{"line":389,"column":0}},{"name":"allGradients","generated":{"line":422,"column":34},"source":"index.js","original":{"line":389,"column":34}},{"generated":{"line":422,"column":46},"source":"index.js","original":{"line":389,"column":0}},{"name":"normalizedRewards","generated":{"line":422,"column":48},"source":"index.js","original":{"line":389,"column":48}},{"generated":{"line":422,"column":65},"source":"index.js","original":{"line":389,"column":0}},{"generated":{"line":422,"column":67},"source":"index.js","original":{"line":389,"column":67}},{"generated":{"line":423,"column":0},"source":"index.js","original":{"line":390,"column":2}},{"name":"tf","generated":{"line":423,"column":9},"source":"index.js","original":{"line":390,"column":9}},{"generated":{"line":423,"column":11},"source":"index.js","original":{"line":390,"column":11}},{"name":"tidy","generated":{"line":423,"column":12},"source":"index.js","original":{"line":390,"column":12}},{"generated":{"line":423,"column":16},"source":"index.js","original":{"line":390,"column":9}},{"generated":{"line":423,"column":17},"source":"index.js","original":{"line":390,"column":17}},{"generated":{"line":423,"column":23},"source":"index.js","original":{"line":390,"column":23}},{"generated":{"line":424,"column":0},"source":"index.js","original":{"line":391,"column":4}},{"name":"gradients","generated":{"line":424,"column":10},"source":"index.js","original":{"line":391,"column":10}},{"generated":{"line":424,"column":19},"source":"index.js","original":{"line":391,"column":19}},{"generated":{"line":424,"column":22},"source":"index.js","original":{"line":391,"column":22}},{"generated":{"line":424,"column":24},"source":"index.js","original":{"line":391,"column":4}},{"generated":{"line":426,"column":0},"source":"index.js","original":{"line":392,"column":4}},{"generated":{"line":426,"column":9},"source":"index.js","original":{"line":392,"column":9}},{"name":"varName","generated":{"line":426,"column":15},"source":"index.js","original":{"line":392,"column":15}},{"generated":{"line":426,"column":22},"source":"index.js","original":{"line":392,"column":4}},{"name":"allGradients","generated":{"line":426,"column":26},"source":"index.js","original":{"line":392,"column":26}},{"generated":{"line":426,"column":38},"source":"index.js","original":{"line":392,"column":4}},{"generated":{"line":426,"column":40},"source":"index.js","original":{"line":392,"column":40}},{"name":"gradients","generated":{"line":427,"column":0},"source":"index.js","original":{"line":393,"column":6}},{"name":"gradients","generated":{"line":427,"column":6},"source":"index.js","original":{"line":393,"column":6}},{"generated":{"line":427,"column":15},"source":"index.js","original":{"line":393,"column":15}},{"name":"varName","generated":{"line":427,"column":16},"source":"index.js","original":{"line":393,"column":16}},{"generated":{"line":427,"column":23},"source":"index.js","original":{"line":393,"column":15}},{"generated":{"line":427,"column":24},"source":"index.js","original":{"line":393,"column":6}},{"name":"tf","generated":{"line":427,"column":27},"source":"index.js","original":{"line":393,"column":27}},{"generated":{"line":427,"column":29},"source":"index.js","original":{"line":393,"column":29}},{"name":"tidy","generated":{"line":427,"column":30},"source":"index.js","original":{"line":393,"column":30}},{"generated":{"line":427,"column":34},"source":"index.js","original":{"line":393,"column":27}},{"generated":{"line":427,"column":35},"source":"index.js","original":{"line":393,"column":35}},{"generated":{"line":427,"column":41},"source":"index.js","original":{"line":393,"column":41}},{"generated":{"line":428,"column":0},"source":"index.js","original":{"line":394,"column":8}},{"generated":{"line":429,"column":0},"source":"index.js","original":{"line":395,"column":8}},{"name":"varGradients","generated":{"line":429,"column":14},"source":"index.js","original":{"line":395,"column":14}},{"generated":{"line":429,"column":26},"source":"index.js","original":{"line":395,"column":26}},{"name":"allGradients","generated":{"line":429,"column":29},"source":"index.js","original":{"line":395,"column":29}},{"generated":{"line":429,"column":41},"source":"index.js","original":{"line":395,"column":41}},{"name":"varName","generated":{"line":429,"column":42},"source":"index.js","original":{"line":395,"column":42}},{"generated":{"line":429,"column":49},"source":"index.js","original":{"line":395,"column":41}},{"generated":{"line":429,"column":50},"source":"index.js","original":{"line":395,"column":29}},{"name":"map","generated":{"line":429,"column":51},"source":"index.js","original":{"line":395,"column":51}},{"generated":{"line":429,"column":54},"source":"index.js","original":{"line":395,"column":29}},{"name":"varGameGradients","generated":{"line":429,"column":55},"source":"index.js","original":{"line":396,"column":12}},{"generated":{"line":429,"column":71},"source":"index.js","original":{"line":396,"column":28}},{"name":"tf","generated":{"line":429,"column":75},"source":"index.js","original":{"line":396,"column":32}},{"generated":{"line":429,"column":77},"source":"index.js","original":{"line":396,"column":34}},{"name":"stack","generated":{"line":429,"column":78},"source":"index.js","original":{"line":396,"column":35}},{"generated":{"line":429,"column":83},"source":"index.js","original":{"line":396,"column":32}},{"name":"varGameGradients","generated":{"line":429,"column":84},"source":"index.js","original":{"line":396,"column":41}},{"generated":{"line":429,"column":100},"source":"index.js","original":{"line":396,"column":32}},{"generated":{"line":429,"column":101},"source":"index.js","original":{"line":395,"column":29}},{"generated":{"line":429,"column":102},"source":"index.js","original":{"line":395,"column":8}},{"generated":{"line":429,"column":103},"source":"index.js","original":{"line":393,"column":41}},{"generated":{"line":429,"column":104},"source":"index.js","original":{"line":397,"column":8}},{"generated":{"line":430,"column":0},"source":"index.js","original":{"line":398,"column":8}},{"generated":{"line":432,"column":0},"source":"index.js","original":{"line":399,"column":8}},{"name":"expandedDims","generated":{"line":432,"column":14},"source":"index.js","original":{"line":399,"column":14}},{"generated":{"line":432,"column":26},"source":"index.js","original":{"line":399,"column":26}},{"generated":{"line":432,"column":29},"source":"index.js","original":{"line":399,"column":29}},{"generated":{"line":432,"column":31},"source":"index.js","original":{"line":399,"column":8}},{"generated":{"line":434,"column":0},"source":"index.js","original":{"line":400,"column":8}},{"generated":{"line":434,"column":13},"source":"index.js","original":{"line":400,"column":13}},{"name":"i","generated":{"line":434,"column":17},"source":"index.js","original":{"line":400,"column":17}},{"generated":{"line":434,"column":18},"source":"index.js","original":{"line":400,"column":18}},{"generated":{"line":434,"column":21},"source":"index.js","original":{"line":400,"column":21}},{"generated":{"line":434,"column":22},"source":"index.js","original":{"line":400,"column":8}},{"name":"i","generated":{"line":434,"column":24},"source":"index.js","original":{"line":400,"column":24}},{"generated":{"line":434,"column":25},"source":"index.js","original":{"line":400,"column":25}},{"name":"varGradients","generated":{"line":434,"column":28},"source":"index.js","original":{"line":400,"column":28}},{"generated":{"line":434,"column":40},"source":"index.js","original":{"line":400,"column":40}},{"generated":{"line":434,"column":41},"source":"index.js","original":{"line":400,"column":41}},{"generated":{"line":434,"column":42},"source":"index.js","original":{"line":400,"column":40}},{"generated":{"line":434,"column":43},"source":"index.js","original":{"line":400,"column":28}},{"name":"rank","generated":{"line":434,"column":44},"source":"index.js","original":{"line":400,"column":44}},{"generated":{"line":434,"column":48},"source":"index.js","original":{"line":400,"column":28}},{"generated":{"line":434,"column":51},"source":"index.js","original":{"line":400,"column":51}},{"generated":{"line":434,"column":52},"source":"index.js","original":{"line":400,"column":8}},{"generated":{"line":434,"column":54},"source":"index.js","original":{"line":400,"column":54}},{"name":"i","generated":{"line":434,"column":56},"source":"index.js","original":{"line":400,"column":56}},{"generated":{"line":434,"column":57},"source":"index.js","original":{"line":400,"column":8}},{"generated":{"line":434,"column":59},"source":"index.js","original":{"line":400,"column":59}},{"name":"expandedDims","generated":{"line":435,"column":0},"source":"index.js","original":{"line":401,"column":10}},{"name":"expandedDims","generated":{"line":435,"column":10},"source":"index.js","original":{"line":401,"column":10}},{"generated":{"line":435,"column":22},"source":"index.js","original":{"line":401,"column":22}},{"name":"push","generated":{"line":435,"column":23},"source":"index.js","original":{"line":401,"column":23}},{"generated":{"line":435,"column":27},"source":"index.js","original":{"line":401,"column":10}},{"generated":{"line":435,"column":28},"source":"index.js","original":{"line":401,"column":28}},{"generated":{"line":435,"column":29},"source":"index.js","original":{"line":401,"column":10}},{"generated":{"line":436,"column":0},"source":"index.js","original":{"line":402,"column":9}},{"generated":{"line":438,"column":0},"source":"index.js","original":{"line":403,"column":8}},{"name":"reshapedNormalizedRewards","generated":{"line":438,"column":14},"source":"index.js","original":{"line":403,"column":14}},{"generated":{"line":438,"column":39},"source":"index.js","original":{"line":403,"column":39}},{"name":"normalizedRewards","generated":{"line":438,"column":42},"source":"index.js","original":{"line":403,"column":42}},{"generated":{"line":438,"column":59},"source":"index.js","original":{"line":403,"column":59}},{"name":"map","generated":{"line":438,"column":60},"source":"index.js","original":{"line":403,"column":60}},{"generated":{"line":438,"column":63},"source":"index.js","original":{"line":403,"column":42}},{"name":"rs","generated":{"line":438,"column":64},"source":"index.js","original":{"line":404,"column":12}},{"generated":{"line":438,"column":66},"source":"index.js","original":{"line":404,"column":14}},{"name":"rs","generated":{"line":438,"column":70},"source":"index.js","original":{"line":404,"column":18}},{"generated":{"line":438,"column":72},"source":"index.js","original":{"line":404,"column":20}},{"name":"reshape","generated":{"line":438,"column":73},"source":"index.js","original":{"line":404,"column":21}},{"generated":{"line":438,"column":80},"source":"index.js","original":{"line":404,"column":18}},{"name":"rs","generated":{"line":438,"column":81},"source":"index.js","original":{"line":404,"column":29}},{"generated":{"line":438,"column":83},"source":"index.js","original":{"line":404,"column":31}},{"name":"shape","generated":{"line":438,"column":84},"source":"index.js","original":{"line":404,"column":32}},{"generated":{"line":438,"column":89},"source":"index.js","original":{"line":404,"column":29}},{"name":"concat","generated":{"line":438,"column":90},"source":"index.js","original":{"line":404,"column":38}},{"generated":{"line":438,"column":96},"source":"index.js","original":{"line":404,"column":29}},{"name":"expandedDims","generated":{"line":438,"column":97},"source":"index.js","original":{"line":404,"column":45}},{"generated":{"line":438,"column":109},"source":"index.js","original":{"line":404,"column":29}},{"generated":{"line":438,"column":110},"source":"index.js","original":{"line":404,"column":18}},{"generated":{"line":438,"column":111},"source":"index.js","original":{"line":403,"column":42}},{"generated":{"line":438,"column":112},"source":"index.js","original":{"line":403,"column":8}},{"generated":{"line":440,"column":0},"source":"index.js","original":{"line":405,"column":8}},{"generated":{"line":440,"column":13},"source":"index.js","original":{"line":405,"column":13}},{"name":"g","generated":{"line":440,"column":17},"source":"index.js","original":{"line":405,"column":17}},{"generated":{"line":440,"column":18},"source":"index.js","original":{"line":405,"column":18}},{"generated":{"line":440,"column":21},"source":"index.js","original":{"line":405,"column":21}},{"generated":{"line":440,"column":22},"source":"index.js","original":{"line":405,"column":8}},{"name":"g","generated":{"line":440,"column":24},"source":"index.js","original":{"line":405,"column":24}},{"generated":{"line":440,"column":25},"source":"index.js","original":{"line":405,"column":25}},{"name":"varGradients","generated":{"line":440,"column":28},"source":"index.js","original":{"line":405,"column":28}},{"generated":{"line":440,"column":40},"source":"index.js","original":{"line":405,"column":40}},{"name":"length","generated":{"line":440,"column":41},"source":"index.js","original":{"line":405,"column":41}},{"generated":{"line":440,"column":47},"source":"index.js","original":{"line":405,"column":8}},{"generated":{"line":440,"column":49},"source":"index.js","original":{"line":405,"column":49}},{"name":"g","generated":{"line":440,"column":51},"source":"index.js","original":{"line":405,"column":51}},{"generated":{"line":440,"column":52},"source":"index.js","original":{"line":405,"column":8}},{"generated":{"line":440,"column":54},"source":"index.js","original":{"line":405,"column":54}},{"generated":{"line":441,"column":0},"source":"index.js","original":{"line":406,"column":10}},{"name":"varGradients","generated":{"line":442,"column":0},"source":"index.js","original":{"line":407,"column":10}},{"name":"varGradients","generated":{"line":442,"column":10},"source":"index.js","original":{"line":407,"column":10}},{"generated":{"line":442,"column":22},"source":"index.js","original":{"line":407,"column":22}},{"name":"g","generated":{"line":442,"column":23},"source":"index.js","original":{"line":407,"column":23}},{"generated":{"line":442,"column":24},"source":"index.js","original":{"line":407,"column":22}},{"generated":{"line":442,"column":25},"source":"index.js","original":{"line":407,"column":10}},{"name":"varGradients","generated":{"line":442,"column":28},"source":"index.js","original":{"line":407,"column":28}},{"generated":{"line":442,"column":40},"source":"index.js","original":{"line":407,"column":40}},{"name":"g","generated":{"line":442,"column":41},"source":"index.js","original":{"line":407,"column":41}},{"generated":{"line":442,"column":42},"source":"index.js","original":{"line":407,"column":40}},{"generated":{"line":442,"column":43},"source":"index.js","original":{"line":407,"column":28}},{"name":"mul","generated":{"line":442,"column":44},"source":"index.js","original":{"line":407,"column":44}},{"generated":{"line":442,"column":47},"source":"index.js","original":{"line":407,"column":28}},{"name":"reshapedNormalizedRewards","generated":{"line":442,"column":48},"source":"index.js","original":{"line":407,"column":48}},{"generated":{"line":442,"column":73},"source":"index.js","original":{"line":407,"column":73}},{"name":"g","generated":{"line":442,"column":74},"source":"index.js","original":{"line":407,"column":74}},{"generated":{"line":442,"column":75},"source":"index.js","original":{"line":407,"column":73}},{"generated":{"line":442,"column":76},"source":"index.js","original":{"line":407,"column":28}},{"generated":{"line":442,"column":77},"source":"index.js","original":{"line":407,"column":10}},{"generated":{"line":443,"column":0},"source":"index.js","original":{"line":408,"column":9}},{"generated":{"line":443,"column":9},"source":"index.js","original":{"line":393,"column":41}},{"generated":{"line":443,"column":10},"source":"index.js","original":{"line":409,"column":8}},{"generated":{"line":444,"column":0},"source":"index.js","original":{"line":410,"column":8}},{"generated":{"line":447,"column":0},"source":"index.js","original":{"line":411,"column":8}},{"name":"tf","generated":{"line":447,"column":15},"source":"index.js","original":{"line":411,"column":15}},{"generated":{"line":447,"column":17},"source":"index.js","original":{"line":411,"column":17}},{"name":"mean","generated":{"line":447,"column":18},"source":"index.js","original":{"line":411,"column":18}},{"generated":{"line":447,"column":22},"source":"index.js","original":{"line":411,"column":15}},{"name":"tf","generated":{"line":447,"column":23},"source":"index.js","original":{"line":411,"column":23}},{"generated":{"line":447,"column":25},"source":"index.js","original":{"line":411,"column":25}},{"name":"concat","generated":{"line":447,"column":26},"source":"index.js","original":{"line":411,"column":26}},{"generated":{"line":447,"column":32},"source":"index.js","original":{"line":411,"column":23}},{"name":"varGradients","generated":{"line":447,"column":33},"source":"index.js","original":{"line":411,"column":33}},{"generated":{"line":447,"column":45},"source":"index.js","original":{"line":411,"column":23}},{"generated":{"line":447,"column":47},"source":"index.js","original":{"line":411,"column":47}},{"generated":{"line":447,"column":48},"source":"index.js","original":{"line":411,"column":23}},{"generated":{"line":447,"column":49},"source":"index.js","original":{"line":411,"column":15}},{"generated":{"line":447,"column":51},"source":"index.js","original":{"line":411,"column":51}},{"generated":{"line":447,"column":52},"source":"index.js","original":{"line":411,"column":15}},{"generated":{"line":447,"column":53},"source":"index.js","original":{"line":411,"column":8}},{"generated":{"line":448,"column":0},"source":"index.js","original":{"line":412,"column":7}},{"generated":{"line":448,"column":7},"source":"index.js","original":{"line":393,"column":27}},{"generated":{"line":448,"column":8},"source":"index.js","original":{"line":393,"column":6}},{"generated":{"line":449,"column":0},"source":"index.js","original":{"line":413,"column":5}},{"generated":{"line":451,"column":0},"source":"index.js","original":{"line":414,"column":4}},{"name":"gradients","generated":{"line":451,"column":11},"source":"index.js","original":{"line":414,"column":11}},{"generated":{"line":451,"column":20},"source":"index.js","original":{"line":414,"column":4}},{"generated":{"line":452,"column":0},"source":"index.js","original":{"line":415,"column":3}},{"generated":{"line":452,"column":3},"source":"index.js","original":{"line":390,"column":9}},{"generated":{"line":452,"column":4},"source":"index.js","original":{"line":390,"column":2}},{"generated":{"line":453,"column":0},"source":"index.js","original":{"line":416,"column":1}},{"generated":{"line":455,"column":0},"source":"index.js","original":{"line":418,"column":0}}],"sources":{"index.js":"/**\n * @license\n * Copyright 2018 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\n/**\n * TensorFlow.js Reinforcement Learning Example: Balancing a Cart-Pole System.\n *\n * The simulation, training, testing and visualization parts are written\n * purely in JavaScript and can run in the web browser with WebGL acceleration.\n *\n * This reinforcement learning (RL) problem was proposed in:\n *\n * - Barto, Sutton, and Anderson, \"Neuronlike Adaptive Elements That Can Solve\n *   Difficult Learning Control Problems,\" IEEE Trans. Syst., Man, Cybern.,\n *   Vol. SMC-13, pp. 834--846, Sept.--Oct. 1983\n * - Sutton, \"Temporal Aspects of Credit Assignment in Reinforcement Learning\",\n *   Ph.D. Dissertation, Department of Computer and Information Science,\n *   University of Massachusetts, Amherst, 1984.\n *\n * It later became one of OpenAI's gym environmnets:\n *   https://github.com/openai/gym/blob/master/gym/envs/classic_control/cartpole.py\n */\n\nimport * as tf from '@tensorflow/tfjs';\n\nimport {maybeRenderDuringTraining, onGameEnd, setUpUI} from './ui';\n\n/**\n * Policy network for controlling the cart-pole system.\n *\n * The role of the policy network is to select an action based on the observed\n * state of the system. In this case, the action is the leftward or rightward\n * force and the observed system state is a four-dimensional vector, consisting\n * of cart position, cart velocity, pole angle and pole angular velocity.\n *\n */\nclass PolicyNetwork {\n  /**\n   * Constructor of PolicyNetwork.\n   *\n   * @param {number | number[] | tf.Model} hiddenLayerSizes\n   *   Can be any of the following\n   *   - Size of the hidden layer, as a single number (for a single hidden\n   *     layer)\n   *   - An Array of numbers (for any number of hidden layers).\n   *   - An instance of tf.Model.\n   */\n  constructor(hiddenLayerSizesOrModel) {\n    if (hiddenLayerSizesOrModel instanceof tf.Model) {\n      this.model = hiddenLayerSizesOrModel;\n    } else {\n      this.createModel(hiddenLayerSizesOrModel);\n    }\n  }\n\n  /**\n   * Create the underlying model of this policy network.\n   *\n   * @param {number | number[]} hiddenLayerSizes Size of the hidden layer, as\n   *   a single number (for a single hidden layer) or an Array of numbers (for\n   *   any number of hidden layers).\n   */\n  createModel(hiddenLayerSizes) {\n    if (!Array.isArray(hiddenLayerSizes)) {\n      hiddenLayerSizes = [hiddenLayerSizes];\n    }\n    this.model = tf.sequential();\n    hiddenLayerSizes.forEach((hiddenLayerSize, i) => {\n      this.model.add(tf.layers.dense({\n        units: hiddenLayerSize,\n        activation: 'elu',\n        // `inputShape` is required only for the first layer.\n        inputShape: i === 0 ? [4] : undefined\n      }));\n    });\n    // The last layer has only one unit. The single output number will be\n    // converted to a probability of selecting the leftward-force action.\n    this.model.add(tf.layers.dense({units: 1}));\n  }\n\n  /**\n   * Train the policy network's model.\n   *\n   * @param {CartPole} cartPoleSystem The cart-pole system object to use during\n   *   training.\n   * @param {tf.train.Optimizer} optimizer An instance of TensorFlow.js\n   *   Optimizer to use for training.\n   * @param {number} discountRate Reward discounting rate: a number between 0\n   *   and 1.\n   * @param {number} numGames Number of game to play for each model parameter\n   *   update.\n   * @param {number} maxStepsPerGame Maximum number of steps to perform during\n   *   a game. If this number is reached, the game will end immediately.\n   * @returns {number[]} The number of steps completed in the `numGames` games\n   *   in this round of training.\n   */\n  async train(\n      cartPoleSystem, optimizer, discountRate, numGames, maxStepsPerGame) {\n    const allGradients = [];\n    const allRewards = [];\n    const gameSteps = [];\n    onGameEnd(0, numGames);\n    for (let i = 0; i < numGames; ++i) {\n      // Randomly initialize the state of the cart-pole system at the beginning\n      // of every game.\n      cartPoleSystem.setRandomState();\n      const gameRewards = [];\n      const gameGradients = [];\n      for (let j = 0; j < maxStepsPerGame; ++j) {\n        // For every step of the game, remember gradients of the policy\n        // network's weights with respect to the probability of the action\n        // choice that lead to the reward.\n        const gradients = tf.tidy(() => {\n          const inputTensor = cartPoleSystem.getStateTensor();\n          return this.getGradientsAndSaveActions(inputTensor).grads;\n        });\n\n        this.pushGradients(gameGradients, gradients);\n        const action = this.currentActions_[0];\n        const isDone = cartPoleSystem.update(action);\n\n        await maybeRenderDuringTraining(cartPoleSystem);\n\n        if (isDone) {\n          // When the game ends before max step count is reached, a reward of\n          // 0 is given.\n          gameRewards.push(0);\n          break;\n        } else {\n          // As long as the game doesn't end, each step leads to a reward of 1.\n          // These reward values will later be \"discounted\", leading to\n          // higher reward values for longer-lasting games.\n          gameRewards.push(1);\n        }\n      }\n      onGameEnd(i + 1, numGames);\n      gameSteps.push(gameRewards.length);\n      this.pushGradients(allGradients, gameGradients);\n      allRewards.push(gameRewards);\n      await tf.nextFrame();\n    }\n\n    tf.tidy(() => {\n      // The following line does three things:\n      // 1. Performs reward discounting, i.e., make recent rewards count more\n      //    than rewards from the further past. The effect is that the reward\n      //    values from a game with many steps become larger than the values\n      //    from a game with fewer steps.\n      // 2. Normalize the rewards, i.e., subtract the global mean value of the\n      //    rewards and divide the result by the global standard deviation of\n      //    the rewards. Together with step 1, this makes the rewards from\n      //    long-lasting games positive and rewards from short-lasting\n      //    negative.\n      // 3. Scale the gradients with the normalized reward values.\n      const normalizedRewards =\n          discountAndNormalizeRewards(allRewards, discountRate);\n      // Add the scaled gradients to the weights of the policy network. This\n      // step makes the policy network more likely to make choices that lead\n      // to long-lasting games in the future (i.e., the crux of this RL\n      // algorithm.)\n      optimizer.applyGradients(\n          scaleAndAverageGradients(allGradients, normalizedRewards));\n    });\n    tf.dispose(allGradients);\n    return gameSteps;\n  }\n\n  getGradientsAndSaveActions(inputTensor) {\n    const f = () => tf.tidy(() => {\n      const [logits, actions] = this.getLogitsAndActions(inputTensor);\n      this.currentActions_ = actions.dataSync();\n      const labels =\n          tf.sub(1, tf.tensor2d(this.currentActions_, actions.shape));\n      return tf.losses.sigmoidCrossEntropy(labels, logits).asScalar();\n    });\n    return tf.variableGrads(f);\n  }\n\n  getCurrentActions() {\n    return this.currentActions_;\n  }\n\n  /**\n   * Get policy-network logits and the action based on state-tensor inputs.\n   *\n   * @param {tf.Tensor} inputs A tf.Tensor instance of shape `[batchSize, 4]`.\n   * @returns {[tf.Tensor, tf.Tensor]}\n   *   1. The logits tensor, of shape `[batchSize, 1]`.\n   *   2. The actions tensor, of shape `[batchSize, 1]`.\n   */\n  getLogitsAndActions(inputs) {\n    return tf.tidy(() => {\n      const logits = this.model.predict(inputs);\n\n      // Get the probability of the leftward action.\n      const leftProb = tf.sigmoid(logits);\n      // Probabilites of the left and right actions.\n      const leftRightProbs = tf.concat([leftProb, tf.sub(1, leftProb)], 1);\n      const actions = tf.multinomial(leftRightProbs, 1, null, true);\n      return [logits, actions];\n    });\n  }\n\n  /**\n   * Get actions based on a state-tensor input.\n   *\n   * @param {tf.Tensor} inputs A tf.Tensor instance of shape `[batchSize, 4]`.\n   * @param {Float32Array} inputs The actions for the inputs, with length\n   *   `batchSize`.\n   */\n  getActions(inputs) {\n    return this.getLogitsAndActions(inputs)[1].dataSync();\n  }\n\n  /**\n   * Push a new dictionary of gradients into records.\n   *\n   * @param {{[varName: string]: tf.Tensor[]}} record The record of variable\n   *   gradient: a map from variable name to the Array of gradient values for\n   *   the variable.\n   * @param {{[varName: string]: tf.Tensor}} gradients The new gradients to push\n   *   into `record`: a map from variable name to the gradient Tensor.\n   */\n  pushGradients(record, gradients) {\n    for (const key in gradients) {\n      if (key in record) {\n        record[key].push(gradients[key]);\n      } else {\n        record[key] = [gradients[key]];\n      }\n    }\n  }\n}\n\n// The IndexedDB path where the model of the policy network will be saved.\nconst MODEL_SAVE_PATH_ = 'indexeddb://cart-pole-v1';\n\n/**\n * A subclass of PolicyNetwork that supports saving and loading.\n */\nexport class SaveablePolicyNetwork extends PolicyNetwork {\n  /**\n   * Constructor of SaveablePolicyNetwork\n   *\n   * @param {number | number[]} hiddenLayerSizesOrModel\n   */\n  constructor(hiddenLayerSizesOrModel) {\n    super(hiddenLayerSizesOrModel);\n  }\n\n  /**\n   * Save the model to IndexedDB.\n   */\n  async saveModel() {\n    return await this.model.save(MODEL_SAVE_PATH_);\n  }\n\n  /**\n   * Load the model fom IndexedDB.\n   *\n   * @returns {SaveablePolicyNetwork} The instance of loaded\n   *   `SaveablePolicyNetwork`.\n   * @throws {Error} If no model can be found in IndexedDB.\n   */\n  static async loadModel() {\n    const modelsInfo = await tf.io.listModels();\n    if (MODEL_SAVE_PATH_ in modelsInfo) {\n      console.log(`Loading existing model...`);\n      const model = await tf.loadModel(MODEL_SAVE_PATH_);\n      console.log(`Loaded model from ${MODEL_SAVE_PATH_}`);\n      return new SaveablePolicyNetwork(model);\n    } else {\n      throw new Error(`Cannot find model at ${MODEL_SAVE_PATH_}.`);\n    }\n  }\n\n  /**\n   * Check the status of locally saved model.\n   *\n   * @returns If the locally saved model exists, the model info as a JSON\n   *   object. Else, `undefined`.\n   */\n  static async checkStoredModelStatus() {\n    const modelsInfo = await tf.io.listModels();\n    return modelsInfo[MODEL_SAVE_PATH_];\n  }\n\n  /**\n   * Remove the locally saved model from IndexedDB.\n   */\n  async removeModel() {\n    return await tf.io.removeModel(MODEL_SAVE_PATH_);\n  }\n\n  /**\n   * Get the sizes of the hidden layers.\n   *\n   * @returns {number | number[]} If the model has only one hidden layer,\n   *   return the size of the layer as a single number. If the model has\n   *   multiple hidden layers, return the sizes as an Array of numbers.\n   */\n  hiddenLayerSizes() {\n    const sizes = [];\n    for (let i = 0; i < this.model.layers.length - 1; ++i) {\n      sizes.push(this.model.layers[i].units);\n    }\n    return sizes.length === 1 ? sizes[0] : sizes;\n  }\n}\n\n/**\n * Discount the reward values.\n *\n * @param {number[]} rewards The reward values to be discounted.\n * @param {number} discountRate Discount rate: a number between 0 and 1, e.g.,\n *   0.95.\n * @returns {tf.Tensor} The discounted reward values as a 1D tf.Tensor.\n */\nfunction discountRewards(rewards, discountRate) {\n  const discountedBuffer = tf.buffer([rewards.length]);\n  let prev = 0;\n  for (let i = rewards.length - 1; i >= 0; --i) {\n    const current = discountRate * prev + rewards[i];\n    discountedBuffer.set(current, i);\n    prev = current;\n  }\n  return discountedBuffer.toTensor();\n}\n\n/**\n * Discount and normalize reward values.\n *\n * This function performs two steps:\n *\n * 1. Discounts the reward values using `discountRate`.\n * 2. Normalize the reward values with the global reward mean and standard\n *    deviation.\n *\n * @param {number[][]} rewardSequences Sequences of reward values.\n * @param {number} discountRate Discount rate: a number between 0 and 1, e.g.,\n *   0.95.\n * @returns {tf.Tensor[]} The discounted and normalize reward values as an\n *   Array of tf.Tensor.\n */\nfunction discountAndNormalizeRewards(rewardSequences, discountRate) {\n  return tf.tidy(() => {\n    const discounted = [];\n    for (const sequence of rewardSequences) {\n      discounted.push(discountRewards(sequence, discountRate))\n    }\n    // Compute the overall mean and stddev.\n    const concatenated = tf.concat(discounted);\n    const mean = tf.mean(concatenated);\n    const std = tf.sqrt(tf.mean(tf.square(concatenated.sub(mean))));\n    // Normalize the reward sequences using the mean and std.\n    const normalized = discounted.map(rs => rs.sub(mean).div(std));\n    return normalized;\n  });\n}\n\n/**\n * Scale the gradient values using normalized reward values and compute average.\n *\n * The gradient values are scaled by the normalized reward values. Then they\n * are averaged across all games and all steps.\n *\n * @param {{[varName: string]: tf.Tensor[][]}} allGradients A map from variable\n *   name to all the gradient values for the variable across all games and all\n *   steps.\n * @param {tf.Tensor[]} normalizedRewards An Array of normalized reward values\n *   for all the games. Each element of the Array is a 1D tf.Tensor of which\n *   the length equals the number of steps in the game.\n * @returns {{[varName: string]: tf.Tensor}} Scaled and averaged gradients\n *   for the variables.\n */\nfunction scaleAndAverageGradients(allGradients, normalizedRewards) {\n  return tf.tidy(() => {\n    const gradients = {};\n    for (const varName in allGradients) {\n      gradients[varName] = tf.tidy(() => {\n        // Stack gradients together.\n        const varGradients = allGradients[varName].map(\n            varGameGradients => tf.stack(varGameGradients));\n        // Expand dimensions of reward tensors to prepare for multiplication\n        // with broadcasting.\n        const expandedDims = [];\n        for (let i = 0; i < varGradients[0].rank - 1; ++i) {\n          expandedDims.push(1);\n        }\n        const reshapedNormalizedRewards = normalizedRewards.map(\n            rs => rs.reshape(rs.shape.concat(expandedDims)));\n        for (let g = 0; g < varGradients.length; ++g) {\n          // This mul() call uses broadcasting.\n          varGradients[g] = varGradients[g].mul(reshapedNormalizedRewards[g]);\n        }\n        // Concatenate the scaled gradients together, then average them across\n        // all the steps of all the games.\n        return tf.mean(tf.concat(varGradients, 0), 0);\n      });\n    }\n    return gradients;\n  });\n}\n\nsetUpUI();\n"},"lineCount":null}},"hash":"8cc154c933adf7413cf53616000b2dfe","cacheData":{"env":{}}}